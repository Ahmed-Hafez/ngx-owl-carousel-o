{"version":3,"sources":["ng://ngx-owl-carousel-o/lib/services/resize.service.ts","null","ng://ngx-owl-carousel-o/lib/carousel/owl-carousel-o-config.ts","ng://ngx-owl-carousel-o/lib/services/logger.service.ts","ng://ngx-owl-carousel-o/lib/services/carousel.service.ts","ng://ngx-owl-carousel-o/lib/services/navigation.service.ts","ng://ngx-owl-carousel-o/lib/services/window-ref.service.ts","ng://ngx-owl-carousel-o/lib/services/document-ref.service.ts","ng://ngx-owl-carousel-o/lib/services/autoplay.service.ts","ng://ngx-owl-carousel-o/lib/services/lazyload.service.ts","ng://ngx-owl-carousel-o/lib/services/animate.service.ts","ng://ngx-owl-carousel-o/lib/services/autoheight.service.ts","ng://ngx-owl-carousel-o/lib/services/hash.service.ts","ng://ngx-owl-carousel-o/lib/carousel/carousel.component.ts","ng://ngx-owl-carousel-o/lib/carousel/stage/stage.component.ts","ng://ngx-owl-carousel-o/lib/carousel/owl-router-link.directive.ts","ng://ngx-owl-carousel-o/lib/carousel/carousel.module.ts"],"names":["ResizeService","eventManager","this","resizeSubject","Subject","addGlobalEventListener","onResize","bind","onLoaded","Object","defineProperty","prototype","asObservable","event","next","windowWidth","Injectable","EventManager","extendStatics","d","b","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__read","o","m","Symbol","iterator","r","e","ar","done","push","value","error","__spread","concat","OwlCarouselOConfig","OwlOptionsMockedTypes","OwlLogger","errorHandler","log","rest","_i","isDevMode","console","handleError","warn","ErrorHandler","CarouselService","logger","_this","items","rtl","isResponsive","isRefreshed","isLoaded","isLoading","isMouseDragable","isGrab","isTouchDragable","transform","transition","width","paddingL","paddingR","current","tags","initializing","animating","dragging","filter","run","cache","_items","relative","_current","id","margin","settings","grid","autoWidth","css","margin-left","margin-right","slidesData","forEach","slide","marginL","marginR","toFixed","widths","merge","_mergers","mergeFit","Math","min","_widths","clones","view","max","size","ceil","append","prepend","repeat","loop","rewind","normalize","unshift","_clones","map","clonedIdPrefix","isActive","isCloned","coordinates","previous","_coordinates","padding","stagePadding","abs","padding-left","padding-right","stageData","findIndex","minimum","maximum","reset","animate","begin","end","inner","outer","matches","center","result","element","_op","item","isCentered","_invalidated","_states","getViewCurSettings","_viewSettingsShipper$","getInitializedState","_initializedCarousel$","getChangeState","_changeSettingsCarousel$","getChangedState","_changedSettingsCarousel$","getTranslateState","_translateCarousel$","getTranslatedState","_translatedCarousel$","getResizeState","_resizeCarousel$","getResizedState","_resizedCarousel$","getRefreshState","_refreshCarousel$","getRefreshedState","_refreshedCarousel$","getDragState","_dragCarousel$","getDraggedState","_draggedCarousel$","setOptions","options","configOptions","checkedOptions","_validateOptions","_options","mockedTypes","setRightOption","type","key","this_1","_isNumeric","_validateItems","_isNumberOrBoolean","_isNumberOrString","_isStringOrBoolean","isArray","isString_1","dots","nav","setCarouselWidth","_width","setup","carouselWidth","slides","setItems","_defineSlidesData","setViewportItemsN","_trigger","property","name","invalidate","viewport","overwrites","responsive","match","keys","Number","owlDOMData","_breakpoint","initialize","enter","mergeN","dataMerge","startPosition","refresh","mouseDrag","touchDrag","sendChanges","leave","navData","dotsData","_optionsLogic","update","_pipe","filteredPipe","all","classes","setCurSlideClasses","is","dimension","Width","curWidth","prepareDragging","stage","transformArr","x","replace","split","y","speed","enterDragging","defineNewCoordsDrag","dragData","pull","delta","difference","pointer","start","pullDrag","finishDragging","dragObj","clickAttacher","currentSlideI","direction","dragEndSpeed","smartSpeed","closest","undefined","Date","getTime","time","coordinate","position","onTransitionEnd","state","part","_speed","_suppress","_release","reciprocalItemsWidth","elementWidth","slice","mergers","odd","even","index","v","multiplier","newPosition","_duration","from","to","factor","revert","distance","setTimeout","prev","_viewport","content","loadMap","Map","load","set","tplRef","get","hashFragment","dataHash","currentClasses","active","cloned","animated","isAnimated","owl-animated-in","isDefAnimatedIn","owl-animated-out","isDefAnimatedOut","animateIn","isCustomAnimatedIn","animateOut","isCustomAnimatedOut","a","data","namespace","stateName","register","object","Type","tag","indexOf","events","_supress","originalEvent","window","touches","changedTouches","pageX","pageY","clientX","clientY","number","isNaN","parseFloat","first","second","NavigationService","carouselService","disabled","htmlText","spyDataStreams","ngOnDestroy","navSubscription","unsubscribe","initializedCarousel$","pipe","tap","_updateNavPages","draw","changedSettings$","refreshedCarousel$","navMerge$","subscribe","_navData","navText","_dotsData","j","lower","upper","pages","dotsEach","slideBy","_pages","innerContent","dotContent","showInnerContent","startI","splice","_updateNavButtons","_updateDots","curActiveDotI","page","pop","_getPosition","successor","standard","moveByDot","dotId","dot","dotsSpeed","toSlideById","WINDOW","InjectionToken","WindowRef","Error","BrowserWindowRef","_super","tslib_1.__extends","windowFactory","browserWindowRef","platformId","isPlatformBrowser","nativeWindow","browserWindowProvider","provide","useClass","windowProvider","useFactory","deps","PLATFORM_ID","WINDOW_PROVIDERS","DOCUMENT","DocumentRef","BrowserDocumentRef","document","documentFactory","browserDocumentRef","nativeDocument","browserDocumentProvider","documentProvider","DOCUMENT_PROVIDERS","AutoplayService","winRef","docRef","autoplaySubscription","autoplay","play","_handleChangeObservable","autoplayMerge$","timeout","_paused","_setAutoPlayInterval","_getNextTimeout","_timeout","clearTimeout","hidden","autoplaySpeed","autoplayTimeout","stop","pause","startPausing","autoplayHoverPause","startPlayingMouseLeave","startPlayingTouchEnd","Inject","args","LazyLoadService","lazyLoadSubscription","isLazyLoad","lazyLoad","changeSettings$","resizedCarousel$","lazyLoadMerge$","_defineLazyLoadSlides","lazyLoadEager","_load","AnimateService","animateSubscription","dragCarousel$","draggedCarousel$","translatedCarousel$","dragTranslatedMerge$","swapping","translateCarousel$","_swap","animateMerge$","left","incoming","outgoing","clear","AutoHeightService","autoHeightSubscription","autoHeight","heightState","autoHeight$","HashService","route","router","hashSubscription","listenToRoute","URLhashListener","newCurSlide","newCurFragment","currentHashFragment","navigate","fragment","relativeTo","hashFragment$","count","skip","ActivatedRoute","Router","nextId","CarouselSlideDirective","_dataMerge","isNumeric","Directive","selector","TemplateRef","Input","SlidesOutputData","CarouselComponent","el","resizeService","navigationService","autoplayService","lazyLoadService","animateService","autoHeightService","hashService","EventEmitter","ngOnInit","carouselWindowWidth","nativeElement","querySelector","clientWidth","ngAfterContentChecked","ngAfterContentInit","toArray","_winResizeWatcher","_slidesChangesSubscription","changes","carouselLoaded","resizeSubscription","_allObservSubscription","_viewCurSettings$","gatherTranslatedData","translated","emit","slidesOutputData","_draggingCarousel$","switchMap","_carouselMerge$","onResize$","delay","responsiveRefreshRate","navSpeed","activeSlides","startPlayML","startPlayTE","Component","template","providers","ElementRef","ContentChildren","Output","StageComponent","zone","renderer","target","moving","ev","_oneMouseTouchMove","_onDragMove","_onDragEnd","listenerOneClick","listen","_drag","onMouseDown","owlDraggable","_onDragStart","onTouchStart","onTouchCancel","onDragStart","onSelectStart","_oneMoveSubsription","_oneDragMove$","_sendChanges","which","_prepareDragging","_pointer","listenerMouseUp","bindOnDragEnd","listenerTouchEnd","runOutsideAngular","listenerOneMouseMove","bindOneMouseTouchMove","listenerOneTouchMove","_difference","listenerATag","_is","blockClickAnchorInDragging","listenerMouseMove","bindOnDragMove","listenerTouchMove","preventDefault","_enterDragging","HTMLAnchorElement","parentElement","stageOrExit","_animate","setStyle","children","_finishDragging","_oneClickHandler","firstC","specificState","_enter","animations","trigger","style","height","NgZone","Renderer2","HostListener","OwlRouterLinkDirective","tabIndex","setAttribute","commands","preserve","onClick","extras","skipLocationChange","attrBoolValue","replaceUrl","stopLink","navigateByUrl","urlTree","createUrlTree","queryParams","preserveQueryParams","queryParamsHandling","preserveFragment","Attribute","OwlRouterLinkWithHrefDirective","locationStrategy","subscription","NavigationEnd","updateTargetUrlAndHref","ngOnChanges","button","ctrlKey","metaKey","shiftKey","href","prepareExternalUrl","serializeUrl","LocationStrategy","HostBinding","routes","NgModule","imports","CommonModule","RouterModule","forChild","declarations","exports"],"mappings":"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","sourcesContent":["import { EventManager } from '@angular/platform-browser';\r\nimport { Observable, Subject } from 'rxjs';\r\nimport { Injectable } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class ResizeService {\r\n  /**\r\n   * Width of window\r\n   */\r\n  public windowWidth: any;\r\n\r\n  /**\r\n   * Makes resizeSubject become Observable\r\n   * @returns Observable of resizeSubject\r\n   */\r\n  get onResize$(): Observable<Window> {\r\n    return this.resizeSubject.asObservable();\r\n  }\r\n\r\n  /**\r\n   * Subject of 'resize' event\r\n   */\r\n  private resizeSubject: Subject<Window>;\r\n\r\n  constructor(private eventManager: EventManager) {\r\n    this.resizeSubject = new Subject();\r\n    this.eventManager.addGlobalEventListener(\r\n      'window',\r\n      'resize',\r\n      this.onResize.bind(this)\r\n    );\r\n    this.eventManager.addGlobalEventListener(\r\n      'window',\r\n      'onload',\r\n      this.onLoaded.bind(this)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Handler of 'resize' event. Passes data throw resizeSubject\r\n   * @param event Event Object of 'resize' event\r\n   */\r\n  private onResize(event: UIEvent) {\r\n    this.resizeSubject.next(<Window>event.target);\r\n  }\r\n\r\n  /**\r\n   * Handler of 'onload' event. Defines the width of window\r\n   * @param event Event Object of 'onload' event\r\n   */\r\n  private onLoaded(event: UIEvent) {\r\n    this.windowWidth = <Window>event.target;\r\n  }\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import { OwlOptions } from \"../models/owl-options.model\";\r\n\r\n/**\r\n * Defaults value of options\r\n */\r\nexport class OwlCarouselOConfig implements OwlOptions {\r\n  items = 3;\r\n  loop = false;\r\n  center = false;\r\n  rewind = false;\r\n\r\n  mouseDrag = true;\r\n  touchDrag = true;\r\n  pullDrag = true;\r\n  freeDrag = false;\r\n\r\n  margin = 0;\r\n  stagePadding = 0;\r\n\r\n  merge = false;\r\n  mergeFit = true;\r\n  autoWidth = false;\r\n\r\n  startPosition = 0;\r\n  rtl = false;\r\n\r\n  smartSpeed = 250;\r\n  fluidSpeed = false;\r\n  dragEndSpeed = false;\r\n\r\n  responsive = {};\r\n  responsiveRefreshRate = 200;\r\n\r\n  // defaults to Navigation\r\n  nav = false;\r\n  navText = [ 'prev', 'next' ];\r\n  navSpeed = false;\r\n  slideBy = 1; // stage moves on 1 width of slide; if slideBy = 2, stage moves on 2 widths of slide\r\n  dots = true;\r\n  dotsEach = false;\r\n  dotsData = false;\r\n  dotsSpeed = false;\r\n\r\n  // defaults to Autoplay\r\n  autoplay = false;\r\n  autoplayTimeout = 5000;\r\n  autoplayHoverPause = false;\r\n  autoplaySpeed = false;\r\n\r\n  // defaults to LazyLoading\r\n  lazyLoad = false;\r\n  lazyLoadEager = 0;\r\n\r\n  // defaults to Animate\r\n  animateOut = false;\r\n  animateIn = false;\r\n\r\n  // defaults to AutoHeight\r\n  autoHeight = false;\r\n\r\n  // defaults to Hash\r\n  URLhashListener = false;\r\n  constructor() { }\r\n}\r\n\r\n/**\r\n * we can't read types from OwlOptions in javascript because of props have undefined value and types of those props are used for validating inputs\r\n * class below is copy of OwlOptions but its all props have string value showing certain type;\r\n * this is class is being used just in method _validateOptions() of CarouselService;\r\n */\r\nexport class OwlOptionsMockedTypes {\r\n  items = 'number';\r\n  loop = 'boolean';\r\n  center = 'boolean';\r\n  rewind = 'boolean';\r\n\r\n  mouseDrag = 'boolean';\r\n  touchDrag = 'boolean';\r\n  pullDrag = 'boolean';\r\n  freeDrag = 'boolean';\r\n\r\n  margin = 'number';\r\n  stagePadding = 'number';\r\n\r\n  merge = 'boolean';\r\n  mergeFit = 'boolean';\r\n  autoWidth = 'boolean';\r\n\r\n  startPosition = 'number|string';\r\n  rtl = 'boolean';\r\n\r\n  smartSpeed = 'number';\r\n  fluidSpeed = 'boolean';\r\n  dragEndSpeed = 'number|boolean';\r\n\r\n  responsive = {};\r\n  responsiveRefreshRate = 'number';\r\n\r\n  // defaults to Navigation\r\n  nav = 'boolean';\r\n  navText = 'string[]';\r\n  navSpeed = 'number|boolean';\r\n  slideBy = 'number|string'; // stage moves on 1 width of slide; if slideBy = 2, stage moves on 2 widths of slide\r\n  dots = 'boolean';\r\n  dotsEach = 'number|boolean';\r\n  dotsData = 'boolean';\r\n  dotsSpeed = 'number|boolean';\r\n\r\n  // defaults to Autoplay\r\n  autoplay = 'boolean';\r\n  autoplayTimeout = 'number';\r\n  autoplayHoverPause = 'boolean';\r\n  autoplaySpeed = 'number|boolean';\r\n\r\n  // defaults to LazyLoading\r\n  lazyLoad = 'boolean';\r\n  lazyLoadEager = 'number';\r\n\r\n  // defaults to Animate\r\n  animateOut = 'string|boolean';\r\n  animateIn = 'string|boolean';\r\n\r\n  // defaults to AutoHeight\r\n  autoHeight = 'boolean';\r\n\r\n  // defaults to Hash\r\n  URLhashListener = \"boolean\";\r\n  constructor() { }\r\n}","import { ErrorHandler, Injectable, isDevMode } from '@angular/core';\r\n\r\n@Injectable()\r\nexport class OwlLogger {\r\n\r\n  constructor(private errorHandler: ErrorHandler) {}\r\n\r\n  log(value: any, ...rest: any[]) {\r\n    if (isDevMode()) {\r\n      console.log(value, ...rest);\r\n    }\r\n  }\r\n\r\n  error(error: Error) {\r\n    this.errorHandler.handleError(error);\r\n  }\r\n\r\n  warn(value: any, ...rest: any[]) {\r\n    console.warn(value, ...rest);\r\n  }\r\n}\r\n","\r\nimport { StageData } from '../models/stage-data.model';\r\n\r\nimport { OwlDOMData } from '../models/owlDOM-data.model';\r\n\r\nimport { Injectable } from '@angular/core';\r\n\r\nimport { CarouselSlideDirective } from '../carousel/carousel.module';\r\nimport { SlideModel } from '../models/slide.model';\r\nimport { Subject, Observable } from 'rxjs';\r\nimport { OwlCarouselOConfig, OwlOptionsMockedTypes } from '../carousel/owl-carousel-o-config';\r\nimport { OwlOptions } from '../models/owl-options.model';\r\n\r\nimport { NavData, DotsData } from '../models/navigation-data.models';\r\nimport { OwlLogger } from './logger.service';\r\n\r\n/**\r\n * Current state information and their tags.\r\n */\r\nexport class States {\r\n  current: {};\r\n  tags: {\r\n    [key: string]: string[];\r\n  };\r\n}\r\n\r\n/**\r\n * Enumeration for types.\r\n * @enum {String}\r\n */\r\nexport enum Type {\r\n\tEvent = 'event',\r\n\tState = 'state'\r\n};\r\n\r\n/**\r\n * Enumeration for width.\r\n * @enum {String}\r\n */\r\nexport enum Width {\r\n\tDefault = 'default',\r\n\tInner = 'inner',\r\n\tOuter = 'outer'\r\n};\r\n\r\n/**\r\n * Model for coords of .owl-stage\r\n */\r\nexport class Coords {\r\n\tx: number;\r\n\ty: number;\r\n}\r\n\r\n/**\r\n * Model for all current data of carousel\r\n */\r\nexport class CarouselCurrentData {\r\n\towlDOMData: OwlDOMData;\r\n\tstageData: StageData;\r\n\tslidesData: SlideModel[];\r\n\tnavData: NavData;\r\n\tdotsData: DotsData;\r\n}\r\n\r\n@Injectable()\r\nexport class CarouselService {\r\n\t/**\r\n   * Subject for passing data needed for managing View\r\n   */\r\n\tprivate _viewSettingsShipper$ = new Subject<CarouselCurrentData>();\r\n\t/**\r\n   * Subject for notification when the carousel got initializes\r\n   */\r\n\tprivate _initializedCarousel$ = new Subject<string>();\r\n\r\n\t/**\r\n   * Subject for notification when the carousel's settings start changinf\r\n   */\r\n\tprivate _changeSettingsCarousel$ = new Subject<any>();\r\n\r\n\t/**\r\n   * Subject for notification when the carousel's settings have changed\r\n   */\r\n\tprivate _changedSettingsCarousel$ = new Subject<any>();\r\n\t/**\r\n   * Subject for notification when the carousel starts translating or moving\r\n   */\r\n\tprivate _translateCarousel$ = new Subject<string>();\r\n\t/**\r\n   * Subject for notification when the carousel stopped translating or moving\r\n   */\r\n\tprivate _translatedCarousel$ = new Subject<string>();\r\n\t/**\r\n   * Subject for notification when the carousel's rebuilding caused by 'resize' event starts\r\n   */\r\n\tprivate _resizeCarousel$ = new Subject<string>();\r\n\t/**\r\n   * Subject for notification  when the carousel's rebuilding caused by 'resize' event is ended\r\n   */\r\n\tprivate _resizedCarousel$ = new Subject<string>();\r\n\t/**\r\n   * Subject for notification when the refresh of carousel starts\r\n   */\r\n\tprivate _refreshCarousel$ = new Subject<string>();\r\n\t/**\r\n   * Subject for notification when the refresh of carousel is ended\r\n   */\r\n\tprivate _refreshedCarousel$ = new Subject<string>();\r\n\t/**\r\n   * Subject for notification when the dragging of carousel starts\r\n   */\r\n\tprivate _dragCarousel$ = new Subject<string>();\r\n\t/**\r\n   * Subject for notification when the dragging of carousel is ended\r\n   */\r\n\tprivate _draggedCarousel$ = new Subject<string>();\r\n\r\n  /**\r\n   * Current settings for the carousel.\r\n   */\r\n  settings: OwlOptions = {\r\n\t\titems: 0\r\n\t};\r\n\r\n\t/**\r\n   * Initial data for setting classes to element .owl-carousel\r\n   */\r\n\towlDOMData: OwlDOMData = {\r\n\t\trtl: false,\r\n\t\tisResponsive: false,\r\n\t\tisRefreshed: false,\r\n\t\tisLoaded: false,\r\n\t\tisLoading: false,\r\n\t\tisMouseDragable: false,\r\n\t\tisGrab: false,\r\n\t\tisTouchDragable: false\r\n\t};\r\n\r\n\t/**\r\n   * Initial data of .owl-stage\r\n   */\r\n\tstageData: StageData = {\r\n\t\ttransform: 'translate3d(0px,0px,0px)',\r\n\t\ttransition: '0s',\r\n\t\twidth: 0,\r\n\t\tpaddingL: 0,\r\n\t\tpaddingR: 0\r\n\t};\r\n\r\n\t/**\r\n\t *  Data of every slide\r\n\t */\r\n\tslidesData: SlideModel[];\r\n\r\n\t/**\r\n\t * Data of navigation block\r\n\t */\r\n\tnavData: NavData;\r\n\r\n\t/**\r\n\t * Data of dots block\r\n\t */\r\n\tdotsData: DotsData;\r\n\r\n\t/**\r\n\t * Carousel width\r\n\t */\r\n\tprivate _width: number;\r\n\r\n\t/**\r\n\t * All real items.\r\n\t */\r\n\tprivate _items: CarouselSlideDirective[] = []; // is equal to this.slides\r\n\r\n\t/**\r\n   * Array with width of every slide.\r\n   */\r\n  private _widths: any[] = [];\r\n\r\n\t/**\r\n   * Currently suppressed events to prevent them from beeing retriggered.\r\n   */\r\n\tprivate _supress: any = {};\r\n\r\n  /**\r\n   * References to the running plugins of this carousel.\r\n   */\r\n\tprivate _plugins: any = {};\r\n\r\n\t/**\r\n   * Absolute current position.\r\n   */\r\n\tprivate _current: number | null = null;\r\n\r\n\t/**\r\n   * All cloned items.\r\n   */\r\n\tprivate _clones: any[] = [];\r\n\r\n  /**\r\n   * Merge values of all items.\r\n   * @todo Maybe this could be part of a plugin.\r\n   */\r\n\tprivate _mergers: any[] = [];\r\n\r\n\t/**\r\n   * Animation speed in milliseconds.\r\n   */\r\n\tprivate _speed: number | null = null;\r\n\r\n\t/**\r\n   * Coordinates of all items in pixel.\r\n   * @todo The name of this member is missleading.\r\n   */\r\n\tprivate _coordinates: number[] = [];\r\n\r\n\t/**\r\n   * Current breakpoint.\r\n   * @todo Real media queries would be nice.\r\n   */\r\n\tprivate _breakpoint: any = null;\r\n\r\n\t/**\r\n\t * Prefix for id of cloned slides\r\n\t */\r\n\tclonedIdPrefix = 'cloned-';\r\n\r\n\t/**\r\n\t * Current options set by the caller including defaults.\r\n\t */\r\n\t_options: OwlOptions = {};\r\n\r\n  /**\r\n   * Invalidated parts within the update process.\r\n   */\r\n  private _invalidated: any = {};\r\n\r\n  // Is needed for tests\r\n  get invalidated() {\r\n    return this._invalidated;\r\n  }\r\n  /**\r\n   * Current state information and their tags.\r\n   */\r\n  private _states: States = {\r\n    current: {},\r\n    tags: {\r\n      initializing: ['busy'],\r\n      animating: ['busy'],\r\n      dragging: ['interacting']\r\n    }\r\n  };\r\n\r\n  // is needed for tests\r\n  get states() {\r\n    return this._states;\r\n\t}\r\n\r\n\t/**\r\n \t * Ordered list of workers for the update process.\r\n   */\r\n  private _pipe: any[] = [\r\n    // {\r\n    //   filter: ['width', 'settings'],\r\n    //   run: () => {\r\n    //     this._width = this.carouselWindowWidth;\r\n    //   }\r\n    // },\r\n    {\r\n      filter: ['width', 'items', 'settings'],\r\n      run: cache => {\r\n        cache.current = this._items && this._items[this.relative(this._current)].id;\r\n      }\r\n    },\r\n    // {\r\n    //   filter: ['items', 'settings'],\r\n    //   run: function() {\r\n    //     // this.$stage.children('.cloned').remove();\r\n    //   }\r\n\t\t// },\r\n\t\t {\r\n      filter: [ 'width', 'items', 'settings' ],\r\n      run: (cache) => {\r\n        const margin = this.settings.margin || '',\r\n          grid = !this.settings.autoWidth,\r\n          rtl = this.settings.rtl,\r\n          css = {\r\n            'margin-left': rtl ? margin : '',\r\n            'margin-right': rtl ? '' : margin\r\n          };\r\n\r\n        if(!grid) {\r\n\t\t\t\t\tthis.slidesData.forEach(slide => {\r\n\t\t\t\t\t\tslide.marginL = css['margin-left'];\r\n\t\t\t\t\t\tslide.marginR = css['margin-right'];\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\r\n        cache.css = css;\r\n      }\r\n    }, {\r\n      filter: [ 'width', 'items', 'settings' ],\r\n      run: (cache) => {\r\n        const width: any = +(this.width() / this.settings.items).toFixed(3) - this.settings.margin,\r\n          grid = !this.settings.autoWidth,\r\n          widths = [];\r\n\t\t\t\tlet merge = null,\r\n\t\t\t\t\t\titerator = this._items.length;\r\n\r\n        cache.items = {\r\n          merge: false,\r\n          width: width\r\n        };\r\n\r\n        while (iterator--) {\r\n          merge = this._mergers[iterator];\r\n          merge = this.settings.mergeFit && Math.min(merge, this.settings.items) || merge;\r\n          cache.items.merge = merge > 1 || cache.items.merge;\r\n\r\n          widths[iterator] = !grid ? this._items[iterator].width ? this._items[iterator].width : width : width * merge;\r\n        }\r\n\r\n\t\t\t\tthis._widths = widths;\r\n\r\n\t\t\t\tthis.slidesData.forEach((slide, i) => {\r\n\t\t\t\t\tslide.width = this._widths[i];\r\n\t\t\t\t\tslide.marginR = cache.css['margin-right'];\r\n\t\t\t\t\tslide.marginL = cache.css['margin-left'];\r\n\t\t\t\t});\r\n      }\r\n    }, {\r\n      filter: [ 'items', 'settings' ],\r\n      run: () => {\r\n        const clones: any[] = [],\r\n          items: CarouselSlideDirective[] = this._items,\r\n          settings: any = this.settings,\r\n          // TODO: Should be computed from number of min width items in stage\r\n          view = Math.max(settings.items * 2, 4),\r\n          size = Math.ceil(items.length / 2) * 2;\r\n\t\t\t\tlet  append: any[] = [],\r\n          prepend: any[] = [],\r\n\t\t\t\t\trepeat = settings.loop && items.length ? settings.rewind ? view : Math.max(view, size) : 0;\r\n\r\n        repeat /= 2;\r\n\r\n        while (repeat--) {\r\n          // Switch to only using appended clones\r\n          clones.push(this.normalize(clones.length / 2, true));\r\n          append.push({ ...this.slidesData[clones[clones.length - 1]]});\r\n\t\t\t\t\tclones.push(this.normalize(items.length - 1 - (clones.length - 1) / 2, true));\r\n\t\t\t\t\tprepend.unshift({ ...this.slidesData[clones[clones.length - 1]]});\r\n        }\r\n\r\n\t\t\t\tthis._clones = clones;\r\n\r\n\t\t\t\tappend = append.map(slide => {\r\n\t\t\t\t\tslide.id = `${this.clonedIdPrefix}${slide.id}`;\r\n\t\t\t\t\tslide.isActive = false;\r\n\t\t\t\t\tslide.isCloned = true;\r\n\t\t\t\t\treturn slide;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tprepend = prepend.map(slide => {\r\n\t\t\t\t\tslide.id = `${this.clonedIdPrefix}${slide.id}`;\r\n\t\t\t\t\tslide.isActive = false;\r\n\t\t\t\t\tslide.isCloned = true;\r\n\t\t\t\t\treturn slide;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tthis.slidesData = prepend.concat(this.slidesData).concat(append);\r\n      }\r\n    }, {\r\n      filter: [ 'width', 'items', 'settings' ],\r\n      run: () => {\r\n        const rtl = this.settings.rtl ? 1 : -1,\r\n          size = this._clones.length + this._items.length,\r\n          coordinates = [];\r\n        let iterator = -1,\r\n          previous = 0,\r\n          current = 0;\r\n\r\n        while (++iterator < size) {\r\n          previous = coordinates[iterator - 1] || 0;\r\n          current = this._widths[this.relative(iterator)] + this.settings.margin;\r\n          coordinates.push(previous + current * rtl);\r\n        }\r\n\r\n        this._coordinates = coordinates;\r\n      }\r\n    }, {\r\n      filter: [ 'width', 'items', 'settings' ],\r\n      run: () => {\r\n        const padding = this.settings.stagePadding,\r\n          coordinates = this._coordinates,\r\n          css = {\r\n            'width': Math.ceil(Math.abs(coordinates[coordinates.length - 1])) + padding * 2,\r\n            'padding-left': padding || '',\r\n            'padding-right': padding || ''\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\tthis.stageData.width = css.width; // use this property in *ngIf directive for .owl-stage element\r\n\t\t\t\tthis.stageData.paddingL = css['padding-left'];\r\n\t\t\t\tthis.stageData.paddingR = css['padding-right'];\r\n      }\r\n    }, {\r\n    //   filter: [ 'width', 'items', 'settings' ],\r\n    //   run: cache => {\r\n\t\t// \t\t// this method sets the width for every slide, but I set it in different way earlier\r\n\t\t// \t\tconst grid = !this.settings.autoWidth,\r\n\t\t// \t\titems = this.$stage.children(); // use this.slidesData\r\n    //     let iterator = this._coordinates.length;\r\n\r\n    //     if (grid && cache.items.merge) {\r\n    //       while (iterator--) {\r\n    //         cache.css.width = this._widths[this.relative(iterator)];\r\n    //         items.eq(iterator).css(cache.css);\r\n    //       }\r\n    //     } else if (grid) {\r\n    //       cache.css.width = cache.items.width;\r\n    //       items.css(cache.css);\r\n    //     }\r\n    //   }\r\n    // }, {\r\n    //   filter: [ 'items' ],\r\n    //   run: function() {\r\n    //     this._coordinates.length < 1 && this.$stage.removeAttr('style');\r\n    //   }\r\n    // }, {\r\n      filter: [ 'width', 'items', 'settings' ],\r\n      run: cache => {\r\n        let current = cache.current ? this.slidesData.findIndex(slide => slide.id === cache.current) : 0;\r\n       \tcurrent = Math.max(this.minimum(), Math.min(this.maximum(), current));\r\n        this.reset(current);\r\n      }\r\n    }, {\r\n      filter: [ 'position' ],\r\n      run: () => {\r\n        this.animate(this.coordinates(this._current));\r\n      }\r\n    }, {\r\n      filter: [ 'width', 'position', 'items', 'settings' ],\r\n      run: () => {\r\n        const rtl = this.settings.rtl ? 1 : -1,\r\n\t\t\t\t\tpadding = this.settings.stagePadding * 2,\r\n\t\t\t\t\tmatches = [];\r\n\t\t\t\tlet begin, end, inner, outer, i, n;\r\n\r\n\t\t\t\tbegin = this.coordinates(this.current());\r\n\t\t\t\tif (typeof begin === 'number' ) {\r\n\t\t\t\t\tbegin += padding;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tbegin = 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tend = begin + this.width() * rtl;\r\n\r\n\t\t\t\tif (rtl === -1 && this.settings.center) {\r\n\t\t\t\t\tconst result =\tthis._coordinates.filter(element => {\r\n\t\t\t\t\t\treturn this.settings.items % 2 === 1 ? element >= begin : element > begin;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tbegin = result.length ? result[result.length - 1] : begin;\r\n\t\t\t\t}\r\n\r\n        for (i = 0, n = this._coordinates.length; i < n; i++) {\r\n          inner = Math.ceil(this._coordinates[i - 1] || 0);\r\n\t\t\t\t\touter = Math.ceil(Math.abs(this._coordinates[i]) + padding * rtl);\r\n\r\n          if ((this._op(inner, '<=', begin) && (this._op(inner, '>', end)))\r\n            || (this._op(outer, '<', begin) && this._op(outer, '>', end))) {\r\n            matches.push(i);\r\n          }\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.slidesData.forEach(slide => {\r\n\t\t\t\t\tslide.isActive = false;\r\n\t\t\t\t\treturn slide;\r\n\t\t\t\t});\r\n\t\t\t\tmatches.forEach(item => {\r\n\t\t\t\t\tthis.slidesData[item].isActive = true;\r\n\t\t\t\t});\r\n\r\n        if (this.settings.center) {\r\n\t\t\t\t\tthis.slidesData.forEach(slide => {\r\n\t\t\t\t\t\tslide.isCentered = false;\r\n\t\t\t\t\t\treturn slide;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthis.slidesData[this.current()].isCentered = true;\r\n        }\r\n      }\r\n    }\r\n  ];\r\n\r\n\tconstructor(private logger: OwlLogger) { }\r\n\r\n\t/**\r\n\t * Makes _viewSettingsShipper$ Subject become Observable\r\n\t * @returns Observable of _viewSettingsShipper$ Subject\r\n\t */\r\n\tgetViewCurSettings(): Observable<CarouselCurrentData> {\r\n\t\treturn this._viewSettingsShipper$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _initializedCarousel$ Subject become Observable\r\n\t * @returns Observable of _initializedCarousel$ Subject\r\n\t */\r\n\tgetInitializedState(): Observable<string> {\r\n\t\treturn this._initializedCarousel$.asObservable()\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _changeSettingsCarousel$ Subject become Observable\r\n\t * @returns Observable of _changeSettingsCarousel$ Subject\r\n\t */\r\n\tgetChangeState(): Observable<any> {\r\n\t\treturn this._changeSettingsCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _changedSettingsCarousel$ Subject become Observable\r\n\t * @returns Observable of _changedSettingsCarousel$ Subject\r\n\t */\r\n\tgetChangedState(): Observable<any> {\r\n\t\treturn this._changedSettingsCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _translateCarousel$ Subject become Observable\r\n\t * @returns Observable of _translateCarousel$ Subject\r\n\t */\r\n\tgetTranslateState(): Observable<string> {\r\n\t\treturn this._translateCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _translatedCarousel$ Subject become Observable\r\n\t * @returns Observable of _translatedCarousel$ Subject\r\n\t */\r\n\tgetTranslatedState(): Observable<string> {\r\n\t\treturn this._translatedCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _resizeCarousel$ Subject become Observable\r\n\t * @returns Observable of _resizeCarousel$ Subject\r\n\t */\r\n\tgetResizeState(): Observable<string> {\r\n\t\treturn this._resizeCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _resizedCarousel$ Subject become Observable\r\n\t * @returns Observable of _resizedCarousel$ Subject\r\n\t */\r\n\tgetResizedState(): Observable<string> {\r\n\t\treturn this._resizedCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _refreshCarousel$ Subject become Observable\r\n\t * @returns Observable of _refreshCarousel$ Subject\r\n\t */\r\n\tgetRefreshState(): Observable<string> {\r\n\t\treturn this._refreshCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _refreshedCarousel$ Subject become Observable\r\n\t * @returns Observable of _refreshedCarousel$ Subject\r\n\t */\r\n\tgetRefreshedState(): Observable<string> {\r\n\t\treturn this._refreshedCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _dragCarousel$ Subject become Observable\r\n\t * @returns Observable of _dragCarousel$ Subject\r\n\t */\r\n\tgetDragState(): Observable<string> {\r\n\t\treturn this._dragCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Makes _draggedCarousel$ Subject become Observable\r\n\t * @returns Observable of _draggedCarousel$ Subject\r\n\t */\r\n\tgetDraggedState(): Observable<string> {\r\n\t\treturn this._draggedCarousel$.asObservable();\r\n\t}\r\n\r\n\t/**\r\n\t * Setups custom options expanding default options\r\n\t * @param options custom options\r\n\t */\r\n\tsetOptions(options: OwlOptions) {\r\n\t\tconst configOptions: OwlOptions = new OwlCarouselOConfig();\r\n\t\tconst checkedOptions: OwlOptions = this._validateOptions(options, configOptions);\r\n\t\tthis._options = { ...configOptions, ...checkedOptions};\r\n\t}\r\n\r\n\t/**\r\n\t * Checks whether user's option are set properly. Cheking is based on typings;\r\n\t * @param options options set by user\r\n\t * @param configOptions default options\r\n\t * @returns checked and modified (if it's needed) user's options\r\n\t *\r\n\t * Notes:\r\n\t * \t- if user set option with wrong type, it'll be written in console\r\n\t */\r\n\tprivate _validateOptions(options: OwlOptions, configOptions: OwlOptions): OwlOptions {\r\n\t\tconst checkedOptions: OwlOptions = { ...options};\r\n\t\tconst mockedTypes = new OwlOptionsMockedTypes();\r\n\r\n\t\tconst setRightOption = (type: string, key: any): OwlOptions => {\r\n\t\t\tthis.logger.log(`options.${key} must be type of ${type}; ${key}=${options[key]} skipped to defaults: ${key}=${configOptions[key]}`);\r\n\t\t\treturn configOptions[key];\r\n\t\t};\r\n\r\n\t\tfor (const key in checkedOptions) {\r\n\t\t\tif (checkedOptions.hasOwnProperty(key)) {\r\n\r\n\t\t\t\t// condition could be shortened but it gets harder for understanding\r\n\t\t\t\tif (mockedTypes[key] === 'number') {\r\n\t\t\t\t\tif (this._isNumeric(checkedOptions[key])) {\r\n\t\t\t\t\t\tcheckedOptions[key] = +checkedOptions[key];\r\n\t\t\t\t\t\tcheckedOptions[key] = key === 'items' ? this._validateItems(checkedOptions[key]) : checkedOptions[key];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcheckedOptions[key] = setRightOption(mockedTypes[key], key);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (mockedTypes[key] === 'boolean' && typeof checkedOptions[key] !== 'boolean') {\r\n\t\t\t\t\tcheckedOptions[key] = setRightOption(mockedTypes[key], key);\r\n\t\t\t\t} else if (mockedTypes[key] === 'number|boolean' && !this._isNumberOrBoolean(checkedOptions[key])) {\r\n\t\t\t\t\tcheckedOptions[key] = setRightOption(mockedTypes[key], key);\r\n\t\t\t\t} else if (mockedTypes[key] === 'number|string' && !this._isNumberOrString(checkedOptions[key])) {\r\n\t\t\t\t\tcheckedOptions[key] = setRightOption(mockedTypes[key], key);\r\n\t\t\t\t} else if (mockedTypes[key] === 'string|boolean' && !this._isStringOrBoolean(checkedOptions[key])) {\r\n\t\t\t\t\tcheckedOptions[key] = setRightOption(mockedTypes[key], key);\r\n\t\t\t\t} else if (mockedTypes[key] === 'string[]') {\r\n\t\t\t\t\tif (Array.isArray(checkedOptions[key])) {\r\n\t\t\t\t\t\tlet isString = false;\r\n\t\t\t\t\t\tcheckedOptions[key].forEach(element => {\r\n\t\t\t\t\t\t\tisString = typeof element === 'string' ? true : false;\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!isString) { checkedOptions[key] = setRightOption(mockedTypes[key], key) };\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcheckedOptions[key] = setRightOption(mockedTypes[key], key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn checkedOptions;\r\n\t}\r\n\r\n\t/**\r\n\t * Checks option items set by user and if it bigger than number of slides then returns number of slides\r\n\t * @param items option items set by user\r\n\t * @returns right number of items\r\n\t */\r\n\tprivate _validateItems(items: number): number {\r\n\t\tlet result: number;\r\n\t\tif (items > this._items.length) {\r\n\t\t\tresult = this._items.length;\r\n\t\t\tthis.logger.log('The option \\'items\\' in your options is bigger than the number of slides. This option is updated to the current number of slides and the navigation got disabled');\r\n\t\t} else {\r\n\t\t\tif (items === this._items.length && (this.settings.dots || this.settings.nav)) {\r\n\t\t\t\tthis.logger.log('Option \\'items\\' in your options is equal to the number of slides. So the navigation got disabled');\r\n\t\t\t}\r\n\t\t\tresult = items;\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Set current width of carousel\r\n\t * @param width width of carousel Window\r\n\t */\r\n\tsetCarouselWidth(width: number) {\r\n\t\tthis._width = width;\r\n\t}\r\n\r\n  /**\r\n\t * Setups the current settings.\r\n\t * @todo Remove responsive classes. Why should adaptive designs be brought into IE8?\r\n\t * @todo Support for media queries by using `matchMedia` would be nice.\r\n\t * @param carouselWidth width of carousel\r\n\t * @param slides array of slides\r\n\t * @param options options set by user\r\n\t */\r\n  setup(carouselWidth: number, slides: CarouselSlideDirective[], options: OwlOptions) {\r\n\t\tthis.setCarouselWidth(carouselWidth);\r\n\t\tthis.setItems(slides);\r\n\t\tthis._defineSlidesData();\r\n\t\tthis.setOptions(options);\r\n\r\n\t\tthis.settings = { ...this._options};\r\n\r\n\t\tthis.setViewportItemsN();\r\n\r\n\t\tthis._trigger('change', { property: { name: 'settings', value: this.settings } });\r\n\t\tthis.invalidate('settings'); // must be call of this function;\r\n\t\tthis._trigger('changed', { property: { name: 'settings', value: this.settings } });\r\n\t}\r\n\r\n\t/**\r\n\t * Set number of items for current viewport\r\n\t */\r\n\tsetViewportItemsN() {\r\n\t\tconst viewport = this._width,\r\n\t\t\toverwrites = this._options.responsive;\r\n\t\tlet\tmatch = -1;\r\n\r\n\t\tif (!Object.keys(overwrites).length) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!viewport) {\r\n\t\t\tthis.settings.items = 1;\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfor (const key in overwrites) {\r\n\t\t\tif (overwrites.hasOwnProperty(key)) {\r\n\t\t\t\tif (+key <= viewport && +key > match) {\r\n\t\t\t\t\tmatch = Number(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tthis.settings = { ...this.settings, items: this._validateItems(overwrites[match].items)};\r\n\t\t// if (typeof this.settings.stagePadding === 'function') {\r\n\t\t// \tthis.settings.stagePadding = this.settings.stagePadding();\r\n\t\t// }\r\n\t\tdelete this.settings.responsive;\r\n\t\tthis.owlDOMData.isResponsive = true;\r\n\t\tthis._breakpoint = match;\r\n\r\n\t\tthis.invalidate('settings');\r\n\t}\r\n\r\n\t/**\r\n\t * Initializes the carousel.\r\n\t * @param slides array of CarouselSlideDirective\r\n\t */\r\n  initialize(slides: CarouselSlideDirective[]) {\r\n\t\tthis.enter('initializing');\r\n\t\t// this.trigger('initialize');\r\n\r\n\t\tthis.owlDOMData.rtl = this.settings.rtl;\r\n\r\n\t\tif (this._mergers.length) {\r\n\t\t\tthis._mergers = [];\r\n\t\t}\r\n\r\n\t\tslides.forEach(item => {\r\n\t\t\tconst mergeN: number = this.settings.merge ? item.dataMerge : 1;\r\n\t\t\tthis._mergers.push(mergeN);\r\n\t\t});\r\n\t\tthis._clones = [];\r\n\r\n\t\tthis.reset(this._isNumeric(this.settings.startPosition) ? +this.settings.startPosition : 0);\r\n\r\n\t\tthis.invalidate('items');\r\n\t\tthis.refresh();\r\n\r\n\t\tthis.owlDOMData.isLoaded = true;\r\n\t\tthis.owlDOMData.isMouseDragable = this.settings.mouseDrag;\r\n\t\tthis.owlDOMData.isTouchDragable = this.settings.touchDrag;\r\n\r\n\t\tthis.sendChanges();\r\n\r\n\t\tthis.leave('initializing');\r\n\t\tthis._trigger('initialized');\r\n\t};\r\n\r\n\t/**\r\n\t * Sends all data needed for View\r\n\t */\r\n\tsendChanges() {\r\n\t\tthis._viewSettingsShipper$.next({\r\n\t\t\towlDOMData: this.owlDOMData,\r\n\t\t\tstageData: this.stageData,\r\n\t\t\tslidesData: this.slidesData,\r\n\t\t\tnavData: this.navData,\r\n\t\t\tdotsData: this.dotsData\r\n\t\t});\r\n\t}\r\n\r\n\r\n  /**\r\n\t * Updates option logic if necessery\r\n\t */\r\n  private _optionsLogic() {\r\n\t\tif (this.settings.autoWidth) {\r\n\t\t\tthis.settings.stagePadding = 0;\r\n\t\t\tthis.settings.merge = false;\r\n\t\t}\r\n\t}\r\n\r\n  /**\r\n   * Updates the view\r\n   */\r\n  update() {\r\n    let i = 0;\r\n    const n = this._pipe.length,\r\n      filter = item => this._invalidated[item],\r\n\t\t\tcache = {};\r\n\r\n    while (i < n) {\r\n      const filteredPipe = this._pipe[i].filter.filter(filter);\r\n      if (this._invalidated.all || filteredPipe.length > 0) {\r\n\t\t\t\tthis._pipe[i].run(cache);\r\n      }\r\n      i++;\r\n\t\t}\r\n\t\tthis.slidesData.forEach(slide => slide.classes = this.setCurSlideClasses(slide));\r\n\t\tthis.sendChanges();\r\n\r\n    this._invalidated = {};\r\n\r\n    if (!this.is('valid')) {\r\n      this.enter('valid');\r\n    }\r\n  }\r\n\r\n  /**\r\n\t * Gets the width of the view.\r\n\t * @param [dimension=Width.Default] The dimension to return\r\n\t * @returns The width of the view in pixel.\r\n\t */\r\n  width(dimension?: Width): number {\r\n\t\tdimension = dimension || Width.Default;\r\n\t\tswitch (dimension) {\r\n\t\t\tcase Width.Inner:\r\n\t\t\tcase Width.Outer:\r\n\t\t\t\treturn this._width;\r\n\t\t\tdefault:\r\n\t\t\t\treturn this._width - this.settings.stagePadding * 2 + this.settings.margin;\r\n\t\t}\r\n\t}\r\n\r\n  /**\r\n\t * Refreshes the carousel primarily for adaptive purposes.\r\n\t */\r\n  refresh() {\r\n\t\tthis.enter('refreshing');\r\n\t\tthis._trigger('refresh');\r\n\t\tthis._defineSlidesData();\r\n\t\tthis.setViewportItemsN();\r\n\r\n\t\tthis._optionsLogic();\r\n\r\n\t\t// this.$element.addClass(this.options.refreshClass);\r\n\r\n\t\tthis.update();\r\n\r\n\t\t// this.$element.removeClass(this.options.refreshClass);\r\n\r\n\t\tthis.leave('refreshing');\r\n\t\tthis._trigger('refreshed');\r\n\t }\r\n\r\n  /**\r\n\t * Checks window `resize` event.\r\n\t * @param curWidth width of .owl-carousel\r\n\t */\r\n  onResize(curWidth: number) {\r\n\t\tif (!this._items.length) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tthis.setCarouselWidth(curWidth);\r\n\r\n\t\tthis.enter('resizing');\r\n\r\n\t\t// if (this.trigger('resize').isDefaultPrevented()) {\r\n\t\t// \tthis.leave('resizing');\r\n\t\t// \treturn false;\r\n\t\t// }\r\n\t\tthis._trigger('resize');\r\n\t\tthis.invalidate('width');\r\n\r\n\t\tthis.refresh();\r\n\r\n\t\tthis.leave('resizing');\r\n\t\tthis._trigger('resized');\r\n\t}\r\n\r\n  /**\r\n\t * Prepares data for dragging carousel. It starts after firing `touchstart` and `mousedown` events.\r\n\t * @todo Horizontal swipe threshold as option\r\n\t * @todo #261\r\n\t * @param event - The event arguments.\r\n\t * @returns stage - object with 'x' and 'y' coordinates of .owl-stage\r\n\t */\r\n  prepareDragging(event: any): Coords {\r\n\t\tlet stage: Coords = null,\r\n\t\t\t\ttransformArr: string[];\r\n\r\n\t\t// could be 5 commented lines below; However there's stage transform in stageData and in updates after each move of stage\r\n    // stage = getComputedStyle(this.el.nativeElement).transform.replace(/.*\\(|\\)| /g, '').split(',');\r\n    // stage = {\r\n    //   x: stage[stage.length === 16 ? 12 : 4],\r\n    //   y: stage[stage.length === 16 ? 13 : 5]\r\n\t\t// };\r\n\r\n\t\ttransformArr = this.stageData.transform.replace(/.*\\(|\\)| |[^,-\\d]\\w|\\)/g, '').split(',');\r\n    stage = {\r\n      x: +transformArr[0],\r\n      y: +transformArr[1]\r\n    };\r\n\r\n\t\tif (this.is('animating')) {\r\n\t\t\tthis.invalidate('position');\r\n    }\r\n\r\n    if (event.type === 'mousedown') {\r\n      this.owlDOMData.isGrab = true;\r\n    }\r\n\r\n\t\tthis.speed(0);\r\n\t\treturn stage;\r\n\t}\r\n\r\n\t/**\r\n\t * Enters into a 'dragging' state\r\n\t */\r\n\tenterDragging() {\r\n\t\tthis.enter('dragging');\r\n    this._trigger('drag');\r\n\t}\r\n\r\n  /**\r\n\t * Defines new coords for .owl-stage while dragging it\r\n\t * @todo #261\r\n\t * @param event the event arguments.\r\n\t * @param dragData initial data got after starting dragging\r\n\t * @returns coords or false\r\n\t */\r\n  defineNewCoordsDrag(event: any, dragData: any): boolean | Coords {\r\n\t\tlet minimum = null,\r\n\t\tmaximum = null,\r\n\t\tpull = null;\r\n\t\tconst\tdelta = this.difference(dragData.pointer, this.pointer(event)),\r\n\t\t\tstage = this.difference(dragData.stage.start, delta);\r\n\r\n\t\tif (!this.is('dragging')) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (this.settings.loop) {\r\n\t\t\tminimum = this.coordinates(this.minimum());\r\n\t\t\tmaximum = +this.coordinates(this.maximum() + 1) - minimum;\r\n\t\t\tstage.x = (((stage.x - minimum) % maximum + maximum) % maximum) + minimum;\r\n\t\t} else {\r\n\t\t\tminimum = this.settings.rtl ? this.coordinates(this.maximum()) : this.coordinates(this.minimum());\r\n\t\t\tmaximum = this.settings.rtl ? this.coordinates(this.minimum()) : this.coordinates(this.maximum());\r\n\t\t\tpull = this.settings.pullDrag ? -1 * delta.x / 5 : 0;\r\n\t\t\tstage.x = Math.max(Math.min(stage.x, minimum + pull), maximum + pull);\r\n\t\t}\r\n\r\n\t\treturn stage;\r\n\t}\r\n\r\n  /**\r\n\t * Finishes dragging of carousel when `touchend` and `mouseup` events fire.\r\n\t * @todo #261\r\n\t * @todo Threshold for click event\r\n\t * @param event the event arguments.\r\n\t * @param dragObj the object with dragging settings and states\r\n\t * @param clickAttacher function which attaches click handler to slide or its children elements in order to prevent event bubling\r\n\t */\r\n  finishDragging(event: any, dragObj: any, clickAttacher: () => void) {\r\n\t\tconst delta = this.difference(dragObj.pointer, this.pointer(event)),\r\n        stage = dragObj.stage.current,\r\n\t\t\t\tdirection = delta.x > +this.settings.rtl ? 'left' : 'right';\r\n\t\tlet currentSlideI: number, current: number, newCurrent: number;\r\n\r\n      if (delta.x !== 0 && this.is('dragging') || !this.is('valid')) {\r\n        this.speed(+this.settings.dragEndSpeed || this.settings.smartSpeed);\r\n\t\t\t\tcurrentSlideI = this.closest(stage.x, delta.x !== 0 ? direction : dragObj.direction);\r\n\t\t\t\tcurrent = this.current();\r\n        newCurrent = this.current(currentSlideI === -1 ? undefined : currentSlideI);\r\n\r\n\t\t\t\tif (current !== newCurrent) {\r\n\t\t\t\t\tthis.invalidate('position');\r\n\t\t\t\t\tthis.update();\r\n\t\t\t\t}\r\n\r\n        dragObj.direction = direction;\r\n\r\n        if (Math.abs(delta.x) > 3 || new Date().getTime() - dragObj.time > 300) {\r\n\t\t\t\t\tclickAttacher();\r\n        }\r\n      }\r\n      if (!this.is('dragging')) {\r\n        return;\r\n      }\r\n\t\t\tthis.leave('dragging');\r\n\t\t\tthis._trigger('dragged')\r\n\t }\r\n\r\n  /**\r\n\t * Gets absolute position of the closest item for a coordinate.\r\n\t * @todo Setting `freeDrag` makes `closest` not reusable. See #165.\r\n\t * @param coordinate The coordinate in pixel.\r\n\t * @param direction The direction to check for the closest item. Ether `left` or `right`.\r\n\t * @returns The absolute position of the closest item.\r\n\t */\r\n  closest(coordinate: number, direction: string): number {\r\n\t\tconst pull = 30,\r\n\t\t\twidth = this.width();\r\n\t\tlet\tcoordinates: number[] = this.coordinates() as number[],\r\n\t\t position = -1;\r\n\r\n\t\tif (this.settings.center) {\r\n\t\t\tcoordinates = coordinates.map(item => {\r\n\t\t\t\tif (item === 0) {\r\n\t\t\t\t\titem += 0.000001;\r\n\t\t\t\t}\r\n\t\t\t\treturn item;\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\t// option 'freeDrag' doesn't have realization and using it here creates problem:\r\n\t\t// variable 'position' stays unchanged (it equals -1 at the begging) and thus method returns -1\r\n\t\t// Returning value is consumed by method current(), which taking -1 as argument calculates the index of new current slide\r\n\t\t// In case of having 5 slides ans 'loop=false; calling 'current(-1)' sets props '_current' as 4. Just last slide remains visible instead of 3 last slides.\r\n\r\n\t\t// if (!this.settings.freeDrag) {\r\n\t\t\t// check closest item\r\n\t\t\tfor (let i = 0; i < coordinates.length; i++) {\r\n\r\n\t\t\t\tif (direction === 'left' && coordinate > coordinates[i] - pull && coordinate < coordinates[i] + pull) {\r\n\t\t\t\t\tposition = i;\r\n\t\t\t\t// on a right pull, check on previous index\r\n\t\t\t\t// to do so, subtract width from value and set position = index + 1\r\n\t\t\t\t} else if (direction === 'right' && coordinate > coordinates[i] - width - pull && coordinate < coordinates[i] - width + pull) {\r\n\t\t\t\t\tposition = i + 1;\r\n\t\t\t\t} else if (this._op(coordinate, '<', coordinates[i])\r\n\t\t\t\t\t&& this._op(coordinate, '>', coordinates[i + 1] || coordinates[i] - width)) {\r\n\t\t\t\t\tposition = direction === 'left' ? i + 1 : i;\r\n\t\t\t\t} else if (direction === null && coordinate > coordinates[i] - pull && coordinate < coordinates[i] + pull) {\r\n\t\t\t\t\tposition = i;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (position !== -1) { break };\r\n\t\t\t}\r\n\t\t// }\r\n\r\n\t\tif (!this.settings.loop) {\r\n\t\t\t// non loop boundries\r\n\t\t\tif (this._op(coordinate, '>', coordinates[this.minimum()])) {\r\n\t\t\t\tposition = coordinate = this.minimum();\r\n\t\t\t} else if (this._op(coordinate, '<', coordinates[this.maximum()])) {\r\n\t\t\t\tposition = coordinate = this.maximum();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn position;\r\n\t }\r\n\r\n  /**\r\n\t * Animates the stage.\r\n\t * @todo #270\r\n\t * @param coordinate The coordinate in pixels.\r\n\t */\r\n  animate(coordinate: number | number[]) {\r\n\t\tconst animate = this.speed() > 0;\r\n\r\n\t\tif (this.is('animating')) {\r\n\t\t\tthis.onTransitionEnd();\r\n\t\t}\r\n\r\n\t\tif (animate) {\r\n\t\t\tthis.enter('animating');\r\n\t\t\tthis._trigger('translate');\r\n\t\t}\r\n\r\n\t\tthis.stageData.transform = 'translate3d(' + coordinate + 'px,0px,0px)';\r\n\t\tthis.stageData.transition = (this.speed() / 1000) + 's';\r\n\r\n\t\t// also there was transition by means of JQuery.animate or css-changing property left\r\n\t }\r\n\r\n  /**\r\n\t * Checks whether the carousel is in a specific state or not.\r\n\t * @param state The state to check.\r\n\t * @returns The flag which indicates if the carousel is busy.\r\n\t */\r\n  is(state: string): boolean {\r\n\t\treturn this._states.current[state] && this._states.current[state] > 0;\r\n  };\r\n\r\n  /**\r\n\t * Sets the absolute position of the current item.\r\n\t * @param position The new absolute position or nothing to leave it unchanged.\r\n\t * @returns The absolute position of the current item.\r\n\t */\r\n  current(position?: number): number {\r\n\t\tif (position === undefined) {\r\n\t\t\treturn this._current;\r\n\t\t}\r\n\r\n\t\tif (this._items.length === 0) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tposition = this.normalize(position);\r\n\r\n\t\tif (this._current !== position) {\r\n\t\t\tconst event = this._trigger('change', { property: { name: 'position', value: position } });\r\n\r\n\t\t\t// if (event.data !== undefined) {\r\n\t\t\t// \tposition = this.normalize(event.data);\r\n\t\t\t// }\r\n\r\n\t\t\tthis._current = position;\r\n\r\n\t\t\tthis.invalidate('position');\r\n\t\t\tthis._trigger('changed', { property: { name: 'position', value: this._current } });\r\n\t\t}\r\n\r\n\t\treturn this._current;\r\n\t }\r\n\r\n  /**\r\n\t * Invalidates the given part of the update routine.\r\n\t * @param part The part to invalidate.\r\n\t * @returns The invalidated parts.\r\n\t */\r\n  invalidate(part: string): string[] {\r\n\t\tif (typeof part === 'string') {\r\n\t\t\tthis._invalidated[part] = true;\r\n\t\t\tif(this.is('valid')) { this.leave('valid'); }\r\n\t\t}\r\n\t\treturn Object.keys(this._invalidated);\r\n  };\r\n\r\n\t/**\r\n\t * Resets the absolute position of the current item.\r\n\t * @param position the absolute position of the new item.\r\n\t */\r\n  reset(position: number) {\r\n\t\tposition = this.normalize(position);\r\n\r\n\t\tif (position === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._speed = 0;\r\n\t\tthis._current = position;\r\n\r\n\t\tthis._suppress([ 'translate', 'translated' ]);\r\n\r\n\t\tthis.animate(this.coordinates(position));\r\n\r\n\t\tthis._release([ 'translate', 'translated' ]);\r\n\t}\r\n\r\n  /**\r\n\t * Normalizes an absolute or a relative position of an item.\r\n\t * @param position The absolute or relative position to normalize.\r\n\t * @param relative Whether the given position is relative or not.\r\n\t * @returns The normalized position.\r\n\t */\r\n  normalize(position: number, relative?: boolean): number {\r\n\t\tconst n = this._items.length,\r\n\t\t\t\t\tm = relative ? 0 : this._clones.length;\r\n\r\n\t\tif (!this._isNumeric(position) || n < 1) {\r\n\t\t\tposition = undefined;\r\n\t\t} else if (position < 0 || position >= n + m) {\r\n\t\t\tposition = ((position - m / 2) % n + n) % n + m / 2;\r\n\t\t}\r\n\r\n\t\treturn position;\r\n\t }\r\n\r\n  /**\r\n\t * Converts an absolute position of an item into a relative one.\r\n\t * @param position The absolute position to convert.\r\n\t * @returns The converted position.\r\n\t */\r\n  relative(position: number): number {\r\n\t\tposition -= this._clones.length / 2;\r\n\t\treturn this.normalize(position, true);\r\n\t}\r\n\r\n  /**\r\n\t * Gets the maximum position for the current item.\r\n\t * @param relative Whether to return an absolute position or a relative position.\r\n\t * @returns number of maximum position\r\n\t */\r\n  maximum(relative: boolean = false): number {\r\n\t\tconst settings = this.settings;\r\n\t\tlet\tmaximum = this._coordinates.length,\r\n\t\t\titerator,\r\n\t\t\treciprocalItemsWidth,\r\n\t\t\telementWidth;\r\n\r\n\t\tif (settings.loop) {\r\n\t\t\tmaximum = this._clones.length / 2 + this._items.length - 1;\r\n\t\t} else if (settings.autoWidth || settings.merge) {\r\n\t\t\titerator = this._items.length;\r\n\t\t\treciprocalItemsWidth = this.slidesData[--iterator].width;\r\n\t\t\telementWidth = this._width;\r\n\t\t\twhile (iterator--) {\r\n\t\t\t\t// it could be use this._items instead of this.slidesData;\r\n\t\t\t\treciprocalItemsWidth += +this.slidesData[iterator].width + this.settings.margin;\r\n\t\t\t\tif (reciprocalItemsWidth > elementWidth) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tmaximum = iterator + 1;\r\n\t\t} else if (settings.center) {\r\n\t\t\tmaximum = this._items.length - 1;\r\n\t\t} else {\r\n\t\t\tmaximum = this._items.length - settings.items;\r\n\t\t}\r\n\r\n\t\tif (relative) {\r\n\t\t\tmaximum -= this._clones.length / 2;\r\n\t\t}\r\n\r\n\t\treturn Math.max(maximum, 0);\r\n\t }\r\n\r\n  /**\r\n\t * Gets the minimum position for the current item.\r\n\t * @param relative Whether to return an absolute position or a relative position.\r\n\t * @returns number of minimum position\r\n\t */\r\n  minimum(relative: boolean = false): number {\r\n\t\treturn relative ? 0 : this._clones.length / 2;\r\n\t}\r\n\r\n  /**\r\n\t * Gets an item at the specified relative position.\r\n\t * @param position The relative position of the item.\r\n\t * @returns The item at the given position or all items if no position was given.\r\n\t */\r\n  items(position?: number): CarouselSlideDirective[] {\r\n\t\tif (position === undefined) {\r\n\t\t\treturn this._items.slice();\r\n\t\t}\r\n\r\n\t\tposition = this.normalize(position, true);\r\n\t\treturn [this._items[position]];\r\n\t }\r\n\r\n  /**\r\n\t * Gets an item at the specified relative position.\r\n\t * @param position The relative position of the item.\r\n\t * @returns The item at the given position or all items if no position was given.\r\n\t */\r\n  mergers(position: number): number | number[] {\r\n\t\tif (position === undefined) {\r\n\t\t\treturn this._mergers.slice();\r\n\t\t}\r\n\r\n\t\tposition = this.normalize(position, true);\r\n\t\treturn this._mergers[position];\r\n\t }\r\n\r\n  /**\r\n\t * Gets the absolute positions of clones for an item.\r\n\t * @param position The relative position of the item.\r\n\t * @returns The absolute positions of clones for the item or all if no position was given.\r\n\t */\r\n  clones(position?: number): number[] {\r\n\t\tconst odd = this._clones.length / 2,\r\n\t\t\teven = odd + this._items.length,\r\n\t\t\tmap = index => index % 2 === 0 ? even + index / 2 : odd - (index + 1) / 2;\r\n\r\n\t\tif (position === undefined) {\r\n\t\t\treturn this._clones.map((v, i) => map(i));\r\n\t\t}\r\n\r\n\t\treturn this._clones.map((v, i) => v === position ? map(i) : null).filter(item => item);\r\n\t}\r\n\r\n  /**\r\n\t * Sets the current animation speed.\r\n\t * @param speed The animation speed in milliseconds or nothing to leave it unchanged.\r\n\t * @returns The current animation speed in milliseconds.\r\n\t */\r\n  speed(speed?: number): number {\r\n\t\tif (speed !== undefined) {\r\n\t\t\tthis._speed = speed;\r\n\t\t}\r\n\r\n\t\treturn this._speed;\r\n\t}\r\n\r\n  /**\r\n\t * Gets the coordinate of an item.\r\n\t * @todo The name of this method is missleanding.\r\n\t * @param position The absolute position of the item within `minimum()` and `maximum()`.\r\n\t * @returns The coordinate of the item in pixel or all coordinates.\r\n\t */\r\n  coordinates(position?: number): number | number[] {\r\n\t\tlet multiplier = 1,\r\n\t\t\tnewPosition = position - 1,\r\n\t\t\tcoordinate,\r\n\t\t\tresult: number[];\r\n\r\n\t\tif (position === undefined) {\r\n\t\t\tresult = this._coordinates.map((item, index) => {\r\n\t\t\t\treturn this.coordinates(index) as number;\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t}\r\n\r\n\t\tif (this.settings.center) {\r\n\t\t\tif (this.settings.rtl) {\r\n\t\t\t\tmultiplier = -1;\r\n\t\t\t\tnewPosition = position + 1;\r\n\t\t\t}\r\n\r\n\t\t\tcoordinate = this._coordinates[position];\r\n\t\t\tcoordinate += (this.width() - coordinate + (this._coordinates[newPosition] || 0)) / 2 * multiplier;\r\n\t\t} else {\r\n\t\t\tcoordinate = this._coordinates[newPosition] || 0;\r\n\t\t}\r\n\r\n\t\tcoordinate = Math.ceil(coordinate);\r\n\r\n\t\treturn coordinate;\r\n\t }\r\n\r\n  /**\r\n\t * Calculates the speed for a translation.\r\n\t * @param from The absolute position of the start item.\r\n\t * @param to The absolute position of the target item.\r\n\t * @param factor [factor=undefined] - The time factor in milliseconds.\r\n\t * @returns The time in milliseconds for the translation.\r\n\t */\r\n  private _duration(from: number, to: number, factor?: number | boolean): number {\r\n\t\tif (factor === 0) {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\r\n\t\treturn Math.min(Math.max(Math.abs(to - from), 1), 6) * Math.abs((+factor || this.settings.smartSpeed));\r\n\t}\r\n\r\n  /**\r\n\t * Slides to the specified item.\r\n\t * @param position The position of the item.\r\n\t * @param speed The time in milliseconds for the transition.\r\n\t */\r\n  to(position: number, speed: number | boolean) {\r\n\t\tlet current = this.current(),\r\n\t\t\trevert = null,\r\n\t\t\tdistance = position - this.relative(current),\r\n\t\t\tmaximum = this.maximum();\r\n\t\tconst\tdirection = +(distance > 0) - +(distance < 0),\r\n\t\t\titems = this._items.length,\r\n\t\t\tminimum = this.minimum();\r\n\r\n\t\tif (this.settings.loop) {\r\n\t\t\tif (!this.settings.rewind && Math.abs(distance) > items / 2) {\r\n\t\t\t\tdistance += direction * -1 * items;\r\n\t\t\t}\r\n\r\n\t\t\tposition = current + distance;\r\n\t\t\trevert = ((position - minimum) % items + items) % items + minimum;\r\n\r\n\t\t\tif (revert !== position && revert - distance <= maximum && revert - distance > 0) {\r\n\t\t\t\tcurrent = revert - distance;\r\n\t\t\t\tposition = revert;\r\n\t\t\t\tthis.reset(current);\r\n\t\t\t\tthis.sendChanges();\r\n\t\t\t}\r\n\t\t} else if (this.settings.rewind) {\r\n\t\t\tmaximum += 1;\r\n\t\t\tposition = (position % maximum + maximum) % maximum;\r\n\t\t} else {\r\n\t\t\tposition = Math.max(minimum, Math.min(maximum, position));\r\n\t\t}\r\n\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.speed(this._duration(current, position, speed));\r\n\t\t\tthis.current(position);\r\n\r\n\t\t\tthis.update();\r\n\t\t}, 0);\r\n\r\n\t}\r\n\r\n  /**\r\n\t * Slides to the next item.\r\n\t * @param speed The time in milliseconds for the transition.\r\n\t */\r\n  next(speed: number | boolean) {\r\n\t\tspeed = speed || false;\r\n\t\tthis.to(this.relative(this.current()) + 1, speed);\r\n\t}\r\n\r\n  /**\r\n\t * Slides to the previous item.\r\n\t * @param speed The time in milliseconds for the transition.\r\n\t */\r\n  prev(speed: number | boolean) {\r\n\t\tspeed = speed || false;\r\n\t\tthis.to(this.relative(this.current()) - 1, speed);\r\n\t}\r\n\r\n  /**\r\n\t * Handles the end of an animation.\r\n\t * @param event - The event arguments.\r\n\t */\r\n  onTransitionEnd(event?: any) {\r\n\t\t// if css2 animation then event object is undefined\r\n\t\tif (event !== undefined) {\r\n\t\t\t// event.stopPropagation();\r\n\r\n\t\t\t// // Catch only owl-stage transitionEnd event\r\n\t\t\t// if ((event.target || event.srcElement || event.originalTarget) !== this.$stage.get(0)\t) {\r\n\t\t\t// \treturn false;\r\n\t\t\t// }\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis.leave('animating');\r\n\t\tthis._trigger('translated');\r\n\t}\r\n\r\n  /**\r\n\t * Gets viewport width.\r\n\t * @returns - The width in pixel.\r\n\t */\r\n  private _viewport(): number {\r\n\t\tlet width;\r\n\t\tif (this._width) {\r\n\t\t\twidth = this._width;\r\n\t\t} else {\r\n\t\t\tthis.logger.log('Can not detect viewport width.');\r\n\t\t}\r\n\t\treturn width;\r\n\t}\r\n\r\n  /**\r\n\t * Sets _items\r\n\t * @param content The list of slides put into CarouselSlideDirectives.\r\n\t */\r\n  setItems(content: CarouselSlideDirective[]) {\r\n\t\tthis._items = content;\r\n\t}\r\n\r\n\t/**\r\n\t * Sets slidesData using this._items\r\n\t */\r\n\tprivate _defineSlidesData() {\r\n\t\t// Maybe creating and using loadMap would be better in LazyLoadService.\r\n\t\t// Hovewer in that case when 'resize' event fires, prop 'load' of all slides will get 'false' and such state of prop will be seen by View during its updating. Accordingly the code will remove slides's content from DOM even if it was loaded before.\r\n\t\t// Thus it would be needed to add that content into DOM again.\r\n\t\t// In order to avoid additional removing/adding loaded slides's content we use loadMap here and set restore state of prop 'load' before the View will get it.\r\n\t\tlet loadMap: Map<string, boolean>;\r\n\r\n\t\tif (this.slidesData && this.slidesData.length) {\r\n\t\t\tloadMap = new Map();\r\n\t\t\tthis.slidesData.forEach(item => {\r\n\t\t\t\tif (item.load) {\r\n\t\t\t\t\tloadMap.set(item.id, item.load);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\r\n\t\tthis.slidesData = this._items.map(slide => {\r\n\t\t\treturn {\r\n\t\t\t\tid: `${slide.id}`,\r\n\t\t\t\tisActive: false,\r\n\t\t\t\ttplRef: slide.tplRef,\r\n\t\t\t\tdataMerge: slide.dataMerge,\r\n\t\t\t\twidth: 0,\r\n\t\t\t\tisCloned: false,\r\n\t\t\t\tload: loadMap ? loadMap.get(slide.id) : false,\r\n\t\t\t\thashFragment: slide.dataHash\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Sets current classes for slide\r\n\t * @param slide Slide of carousel\r\n\t * @returns object with names of css-classes which are keys and true/false values\r\n\t */\r\n\tsetCurSlideClasses(slide: SlideModel): {[key: string]: boolean} {\r\n\t\t// CSS classes: added/removed per current state of component properties\r\n\t\tconst currentClasses: {[key: string]: boolean} =  {\r\n\t\t\t'active': slide.isActive,\r\n\t\t\t'center': slide.isCentered,\r\n\t\t\t'cloned': slide.isCloned,\r\n\t\t\t'animated': slide.isAnimated,\r\n\t\t\t'owl-animated-in': slide.isDefAnimatedIn,\r\n\t\t\t'owl-animated-out': slide.isDefAnimatedOut\r\n\t\t};\r\n\t\tif (this.settings.animateIn) {\r\n\t\t\tcurrentClasses[this.settings.animateIn as string] = slide.isCustomAnimatedIn;\r\n\t\t}\r\n\t\tif (this.settings.animateOut) {\r\n\t\t\tcurrentClasses[this.settings.animateOut as string] = slide.isCustomAnimatedOut;\r\n\t\t}\r\n\t\treturn currentClasses;\r\n\t}\r\n\r\n  /**\r\n\t * Operators to calculate right-to-left and left-to-right.\r\n\t * @param a - The left side operand.\r\n\t * @param o - The operator.\r\n\t * @param b - The right side operand.\r\n\t * @returns true/false meaning right-to-left or left-to-right\r\n\t */\r\n  private _op(a: number, o: string, b: number): boolean {\r\n\t\tconst rtl = this.settings.rtl;\r\n\t\tswitch (o) {\r\n\t\t\tcase '<':\r\n\t\t\t\treturn rtl ? a > b : a < b;\r\n\t\t\tcase '>':\r\n\t\t\t\treturn rtl ? a < b : a > b;\r\n\t\t\tcase '>=':\r\n\t\t\t\treturn rtl ? a <= b : a >= b;\r\n\t\t\tcase '<=':\r\n\t\t\t\treturn rtl ? a >= b : a <= b;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\r\n  /**\r\n\t * Triggers a public event.\r\n\t * @todo Remove `status`, `relatedTarget` should be used instead.\r\n\t * @param name The event name.\r\n\t * @param data The event data.\r\n\t * @param namespace The event namespace.\r\n\t * @param state The state which is associated with the event.\r\n\t * @param enter Indicates if the call enters the specified state or not.\r\n\t */\r\n  private _trigger(name: string, data?: any, namespace?: string, state?: string, enter?: boolean) {\r\n\t\tswitch (name) {\r\n\t\t\tcase 'initialized':\r\n\t\t\t\tthis._initializedCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'change':\r\n\t\t\t\tthis._changeSettingsCarousel$.next(data);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'changed':\r\n\t\t\t\tthis._changedSettingsCarousel$.next(data);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'drag':\r\n\t\t\t\tthis._dragCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'dragged':\r\n\t\t\t\tthis._draggedCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'resize':\r\n\t\t\t\tthis._resizeCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'resized':\r\n\t\t\t\tthis._resizedCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'refresh':\r\n\t\t\t\tthis._refreshCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'refreshed':\r\n\t\t\t\tthis._refreshedCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'translate':\r\n\t\t\t\tthis._translateCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'translated':\r\n\t\t\t\tthis._translatedCarousel$.next(name);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enters a state.\r\n\t * @param name - The state name.\r\n\t */\r\n  enter(name: string) {\r\n    [ name ].concat(this._states.tags[name] || []).forEach((stateName) => {\r\n      if (this._states.current[stateName] === undefined) {\r\n\t\t\t\tthis._states.current[stateName] = 0;\r\n\t\t\t}\r\n\r\n\t\t\tthis._states.current[stateName]++;\r\n    });\r\n  };\r\n\r\n  /**\r\n\t * Leaves a state.\r\n\t * @param name - The state name.\r\n\t */\r\n\tleave(name: string) {\r\n    [ name ].concat(this._states.tags[name] || []).forEach((stateName) => {\r\n      if (this._states.current[stateName] === 0 || !!this._states.current[stateName]) {\r\n        this._states.current[stateName]--;\r\n      }\r\n    })\r\n  };\r\n\r\n  /**\r\n\t * Registers an event or state.\r\n\t * @param object - The event or state to register.\r\n\t */\r\n  register(object: any) {\r\n\t\tif (object.type === Type.State) {\r\n\t\t\tif (!this._states.tags[object.name]) {\r\n\t\t\t\tthis._states.tags[object.name] = object.tags;\r\n\t\t\t} else {\r\n\t\t\t\tthis._states.tags[object.name] = this._states.tags[object.name].concat(object.tags);\r\n\t\t\t}\r\n\r\n\t\t\tthis._states.tags[object.name] = this._states.tags[object.name].filter((tag, i) => {\r\n\t\t\t\treturn this._states.tags[object.name].indexOf(tag) === i;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n  /**\r\n\t * Suppresses events.\r\n\t * @param events The events to suppress.\r\n\t */\r\n  private _suppress(events: string[]) {\r\n\t\tevents.forEach(event => {\r\n\t\t\tthis._supress[event] = true;\r\n\t\t});\r\n\t}\r\n\r\n  /**\r\n\t * Releases suppressed events.\r\n\t * @param events The events to release.\r\n\t */\r\n  private _release(events: string[]) {\r\n\t\tevents.forEach(event => {\r\n\t\t\tdelete this._supress[event];\r\n\t\t});\r\n\t }\r\n\r\n  /**\r\n\t * Gets unified pointer coordinates from event.\r\n\t * @todo #261\r\n\t * @param event The `mousedown` or `touchstart` event.\r\n\t * @returns Object Coords which contains `x` and `y` coordinates of current pointer position.\r\n\t */\r\n\tpointer(event: any): Coords {\r\n\t\tconst result = { x: null, y: null };\r\n\r\n\t\tevent = event.originalEvent || event || window.event;\r\n\r\n\t\tevent = event.touches && event.touches.length ?\r\n\t\t\tevent.touches[0] : event.changedTouches && event.changedTouches.length ?\r\n\t\t\t\tevent.changedTouches[0] : event;\r\n\r\n\t\tif (event.pageX) {\r\n\t\t\tresult.x = event.pageX;\r\n\t\t\tresult.y = event.pageY;\r\n\t\t} else {\r\n\t\t\tresult.x = event.clientX;\r\n\t\t\tresult.y = event.clientY;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t }\r\n\r\n  /**\r\n\t * Determines if the input is a Number or something that can be coerced to a Number\r\n\t * @param number The input to be tested\r\n\t * @returns An indication if the input is a Number or can be coerced to a Number\r\n\t */\r\n  private _isNumeric(number: any): boolean {\r\n\t\treturn !isNaN(parseFloat(number));\r\n\t}\r\n\r\n\t/**\r\n\t * Determines whether value is number or boolean type\r\n\t * @param value The input to be tested\r\n\t * @returns An indication if the input is a Number or can be coerced to a Number, or Boolean\r\n\t */\r\n\tprivate _isNumberOrBoolean(value: number | boolean): boolean {\r\n\t\treturn this._isNumeric(value) || typeof value === 'boolean';\r\n\t}\r\n\r\n\t/**\r\n\t * Determines whether value is number or string type\r\n\t * @param value The input to be tested\r\n\t * @returns An indication if the input is a Number or can be coerced to a Number, or String\r\n\t */\r\n\tprivate _isNumberOrString(value: number | string): boolean {\r\n\t\treturn this._isNumeric(value) || typeof value === 'string';\r\n\t}\r\n\r\n\t/**\r\n\t * Determines whether value is number or string type\r\n\t * @param value The input to be tested\r\n\t * @returns An indication if the input is a Number or can be coerced to a Number, or String\r\n\t */\r\n\tprivate _isStringOrBoolean(value: number | string): boolean {\r\n\t\treturn typeof value === 'string' || typeof value === 'boolean';\r\n\t}\r\n\r\n  /**\r\n\t * Gets the difference of two vectors.\r\n\t * @todo #261\r\n\t * @param first The first vector.\r\n\t * @param second- The second vector.\r\n\t * @returns The difference.\r\n\t */\r\n  difference(first: Coords, second: Coords): Coords {\r\n\t\treturn {\r\n\t\t\tx: first.x - second.x,\r\n\t\t\ty: first.y - second.y\r\n\t\t};\r\n\t}\r\n\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { NavData, DotsData } from '../models/navigation-data.models';\r\nimport { CarouselSlideDirective } from '../carousel/carousel.module';\r\nimport { CarouselService } from './carousel.service';\r\nimport { Subscription, Observable, merge } from 'rxjs';\r\nimport { tap, filter } from 'rxjs/operators';\r\nimport { OwlOptions } from '../models/owl-options.model';\r\n\r\n@Injectable()\r\nexport class NavigationService implements OnDestroy {\r\n  /**\r\n   * Subscrioption to merge Observable  from CarouselService\r\n   */\r\n  navSubscription: Subscription;\r\n\r\n  /**\r\n   * Indicates whether the plugin is initialized or not.\r\n   */\r\n  protected _initialized = false;\r\n\r\n  /**\r\n   * The current paging indexes.\r\n   */\r\n  protected _pages: any[] = [];\r\n\r\n  /**\r\n   * Data for navigation elements of the user interface.\r\n   */\r\n  protected _navData: NavData = {\r\n    disabled: false,\r\n    prev: {\r\n      disabled: false,\r\n      htmlText: ''\r\n    },\r\n    next: {\r\n      disabled: false,\r\n      htmlText: ''\r\n    },\r\n  };\r\n\r\n  /**\r\n   * Data for dot elements of the user interface.\r\n   */\r\n  protected _dotsData: DotsData = {\r\n    disabled: false,\r\n    dots: []\r\n  };\r\n\r\n  constructor(private carouselService: CarouselService) {\r\n    this.spyDataStreams();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.navSubscription.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Defines Observables which service must observe\r\n   */\r\n  spyDataStreams() {\r\n    const initializedCarousel$: Observable<string> = this.carouselService.getInitializedState().pipe(\r\n      tap(state => {\r\n        this.initialize();\r\n        this._updateNavPages();\r\n        this.draw();\r\n        this.update();\r\n        this.carouselService.sendChanges();\r\n      })\r\n    );\r\n\r\n    // mostly changes in carouselService and carousel at all causes carouselService.to(). It moves stage right-left by its code and calling needed functions\r\n    // Thus this method by calling carouselService.current(position) notifies about changes\r\n    const changedSettings$: Observable<any> = this.carouselService.getChangedState().pipe(\r\n      filter(data => data.property.name === 'position'),\r\n      tap(data => {\r\n        this.update();\r\n        // should be the call of the function written at the end of comment\r\n        // but the method carouselServive.to() has setTimeout(f, 0) which contains carouselServive.update() which calls sendChanges() method.\r\n        // carouselService.navData and carouselService.dotsData update earlier than carouselServive.update() gets called\r\n        // updates of carouselService.navData and carouselService.dotsData are being happening withing carouselService.current(position) method which calls next() of _changedSettingsCarousel$\r\n        // carouselService.current(position) is being calling earlier than carouselServive.update();\r\n        // this.carouselService.sendChanges();\r\n      })\r\n    );\r\n\r\n    const refreshedCarousel$: Observable<string> = this.carouselService.getRefreshedState().pipe(\r\n      tap(() => {\r\n        this._updateNavPages();\r\n        this.draw();\r\n        this.update();\r\n        this.carouselService.sendChanges();\r\n      })\r\n    );\r\n\r\n    const navMerge$: Observable<string> = merge(initializedCarousel$, changedSettings$, refreshedCarousel$);\r\n    this.navSubscription = navMerge$.subscribe(\r\n      () => {}\r\n    );\r\n  }\r\n\r\n  /**\r\n\t * Initializes the layout of the plugin and extends the carousel.\r\n\t */\r\n\tinitialize() {\r\n    this._navData.disabled = true;\r\n    this._navData.prev.htmlText = this.carouselService.settings.navText[0];\r\n    this._navData.next.htmlText = this.carouselService.settings.navText[1];\r\n\r\n    this._dotsData.disabled = true;\r\n\r\n    this.carouselService.navData = this._navData;\r\n    this.carouselService.dotsData = this._dotsData;\r\n  }\r\n\r\n  /**\r\n   * Calculates internal states and updates prop _pages\r\n   */\r\n\tprivate _updateNavPages() {\r\n\t\tlet i: number, j: number, k: number;\r\n\t\tconst lower: number = this.carouselService.clones().length / 2,\r\n      upper: number = lower + this.carouselService.items().length,\r\n      maximum: number = this.carouselService.maximum(true),\r\n      pages: any[] = [],\r\n      settings: OwlOptions = this.carouselService.settings;\r\n     let size = settings.center || settings.autoWidth || settings.dotsData\r\n        ? 1 : settings.dotsEach || settings.items;\r\n      size = +size;\r\n\t\tif (settings.slideBy !== 'page') {\r\n\t\t\tsettings.slideBy = Math.min(+settings.slideBy, settings.items);\r\n\t\t}\r\n\r\n\t\tif (settings.dots || settings.slideBy === 'page') {\r\n\r\n\t\t\tfor (i = lower, j = 0, k = 0; i < upper; i++) {\r\n\t\t\t\tif (j >= size || j === 0) {\r\n\t\t\t\t\tpages.push({\r\n\t\t\t\t\t\tstart: Math.min(maximum, i - lower),\r\n\t\t\t\t\t\tend: i - lower + size - 1\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (Math.min(maximum, i - lower) === maximum) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tj = 0, ++k;\r\n\t\t\t\t}\r\n\t\t\t\tj += this.carouselService.mergers(this.carouselService.relative(i)) as number;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._pages = pages;\r\n\t}\r\n\r\n  /**\r\n\t * Draws the user interface.\r\n\t * @todo The option `dotsData` wont work.\r\n\t */\r\n  draw() {\r\n\t\tlet difference: number;\r\n    const\tsettings: OwlOptions = this.carouselService.settings,\r\n      items: CarouselSlideDirective[] = this.carouselService.items(),\r\n      disabled = items.length <= settings.items;\r\n\r\n\t\tthis._navData.disabled = !settings.nav || disabled;\r\n\t\tthis._dotsData.disabled = !settings.dots || disabled;\r\n\r\n\t\tif (settings.dots) {\r\n\t\t\tdifference = this._pages.length - this._dotsData.dots.length;\r\n\r\n\t\t\tif (settings.dotsData && difference !== 0) {\r\n        this._dotsData.dots = [];\r\n        items.forEach(item => {\r\n          this._dotsData.dots.push({\r\n            active: false,\r\n            id: `dot-${item.id}`,\r\n            innerContent: item.dotContent,\r\n            showInnerContent: true\r\n          });\r\n        });\r\n\t\t\t} else if (difference > 0) {\r\n        const startI: number = this._dotsData.dots.length > 0 ? this._dotsData.dots.length : 0;\r\n        for (let i = 0; i < difference; i++) {\r\n          this._dotsData.dots.push({\r\n            active: false,\r\n            id: `dot-${i + startI}`,\r\n            showInnerContent: false\r\n          });\r\n        }\r\n\t\t\t} else if (difference < 0) {\r\n        this._dotsData.dots.splice(difference, Math.abs(difference))\r\n\t\t\t}\r\n    }\r\n\r\n    this.carouselService.navData = this._navData;\r\n    this.carouselService.dotsData = this._dotsData;\r\n  };\r\n\r\n  /**\r\n   * Updates navigation buttons's and dots's states\r\n   */\r\n  update() {\r\n    this._updateNavButtons();\r\n    this._updateDots();\r\n  }\r\n\r\n  /**\r\n   * Changes state of nav buttons (disabled, enabled)\r\n   */\r\n  private _updateNavButtons() {\r\n    const\tsettings: OwlOptions = this.carouselService.settings,\r\n      loop: boolean = settings.loop || settings.rewind,\r\n      index: number = this.carouselService.relative(this.carouselService.current());\r\n\r\n    if (settings.nav) {\r\n      this._navData.prev.disabled = !loop && index <= this.carouselService.minimum(true);\r\n\t\t\tthis._navData.next.disabled = !loop && index >= this.carouselService.maximum(true);\r\n    }\r\n\r\n    this.carouselService.navData = this._navData;\r\n  }\r\n\r\n  /**\r\n   * Changes active dot if page becomes changed\r\n   */\r\n  private _updateDots() {\r\n    let curActiveDotI: number;\r\n    this._dotsData.dots.forEach(item => {\r\n      if (item.active === true) {\r\n        item.active = false;\r\n      }\r\n    })\r\n\r\n    curActiveDotI = this._current();\r\n    if (this._dotsData.dots.length) {\r\n      this._dotsData.dots[curActiveDotI].active = true;\r\n    }\r\n    this.carouselService.dotsData = this._dotsData;\r\n  }\r\n\r\n  /**\r\n\t * Gets the current page position of the carousel.\r\n\t * @returns the current page position of the carousel\r\n\t */\r\n\tprivate _current(): any {\r\n    const current: number = this.carouselService.relative(this.carouselService.current());\r\n    let finalCurrent: number;\r\n    const pages: any = this._pages.filter((page, index) => {\r\n      return page.start <= current && page.end >= current;\r\n    }).pop();\r\n\r\n    finalCurrent = this._pages.findIndex(page => {\r\n      return page.start === pages.start && page.end === pages.end;\r\n    });\r\n\r\n    return finalCurrent;\r\n  };\r\n\r\n  /**\r\n\t * Gets the current succesor/predecessor position.\r\n   * @param sussessor position of slide\r\n\t * @returns the current succesor/predecessor position\r\n\t */\r\n\tprivate _getPosition(successor: number | boolean): number {\r\n\t\tlet position: number, length: number;\r\n\t\tconst\tsettings: OwlOptions = this.carouselService.settings;\r\n\r\n\t\tif (settings.slideBy === 'page') {\r\n\t\t\tposition = this._current();\r\n\t\t\tlength = this._pages.length;\r\n\t\t\tsuccessor ? ++position : --position;\r\n\t\t\tposition = this._pages[((position % length) + length) % length].start;\r\n\t\t} else {\r\n\t\t\tposition = this.carouselService.relative(this.carouselService.current());\r\n\t\t\tlength = this.carouselService.items().length;\r\n\t\t\tsuccessor ? position += +settings.slideBy : position -= +settings.slideBy;\r\n\t\t}\r\n\r\n\t\treturn position;\r\n  };\r\n\r\n  /**\r\n\t * Slides to the next item or page.\r\n\t * @param speed The time in milliseconds for the transition.\r\n\t */\r\n\tnext(speed: number | boolean) {\r\n    this.carouselService.to(this._getPosition(true), speed);\r\n\t};\r\n\r\n\t/**\r\n\t * Slides to the previous item or page.\r\n\t * @param speed The time in milliseconds for the transition.\r\n\t */\r\n\tprev(speed: number | boolean) {\r\n    this.carouselService.to(this._getPosition(false), speed);\r\n  };\r\n\r\n \t/**\r\n\t * Slides to the specified item or page.\r\n\t * @param position - The position of the item or page.\r\n\t * @param speed - The time in milliseconds for the transition.\r\n\t * @param standard - Whether to use the standard behaviour or not. Default meaning false\r\n\t */\r\n\tto(position: number, speed: number | boolean, standard?: boolean) {\r\n\t\tlet length: number;\r\n\t\tif (!standard && this._pages.length) {\r\n      length = this._pages.length;\r\n      this.carouselService.to(this._pages[((position % length) + length) % length].start, speed);\r\n\t\t} else {\r\n      this.carouselService.to(position, speed);\r\n\t\t}\r\n  };\r\n\r\n  /**\r\n   * Moves carousel after user's clicking on any dots\r\n   */\r\n  moveByDot(dotId: string) {\r\n    const index: number = this._dotsData.dots.findIndex(dot => dotId === dot.id);\r\n    this.to(index, this.carouselService.settings.dotsSpeed);\r\n  }\r\n\r\n  /**\r\n   * rewinds carousel to slide with needed id\r\n   * @param id id of slide\r\n   */\r\n  toSlideById(id: string) {\r\n    const position = this.carouselService.slidesData.findIndex(slide => slide.id === id && slide.isCloned === false);\r\n\r\n    if (position === -1 || position === this.carouselService.current()) {\r\n      return;\r\n    }\r\n\r\n\t\tthis.carouselService.to(this.carouselService.relative(position), false);\r\n  }\r\n\r\n}\r\n","// import { Injectable } from '@angular/core';\r\n// function _window(): any {\r\n//    // return the global native browser window object\r\n//    return window;\r\n// }\r\n// @Injectable()\r\n// export class WindowRefService {\r\n//    get nativeWindow(): any {\r\n//       return _window();\r\n//    }\r\n// }\r\n\r\nimport { isPlatformBrowser } from '@angular/common';\r\nimport {\r\n  ClassProvider,\r\n  FactoryProvider,\r\n  InjectionToken,\r\n  PLATFORM_ID\r\n} from '@angular/core';\r\n\r\n/**\r\n * Create a new injection token for injecting the window into a component.\r\n */\r\nexport const WINDOW = new InjectionToken('WindowToken');\r\n\r\n/**\r\n * Define abstract class for obtaining reference to the global window object.\r\n */\r\nexport abstract class WindowRef {\r\n  get nativeWindow(): Window | Object {\r\n    throw new Error('Not implemented.');\r\n  }\r\n}\r\n\r\n/**\r\n * Define class that implements the abstract class and returns the native window object.\r\n */\r\nexport class BrowserWindowRef extends WindowRef {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  /**\r\n   * @returns window object\r\n   */\r\n  get nativeWindow(): Window | Object {\r\n    return window;\r\n  }\r\n}\r\n\r\n/**\r\n * Create an factory function that returns the native window object.\r\n * @param browserWindowRef Native window object\r\n * @param platformId id of platform\r\n * @returns type of platform of empty object\r\n */\r\nexport function windowFactory(\r\n  browserWindowRef: BrowserWindowRef,\r\n  platformId: Object\r\n): Window | Object {\r\n  if (isPlatformBrowser(platformId)) {\r\n    return browserWindowRef.nativeWindow;\r\n  }\r\n  return new Object();\r\n}\r\n\r\n/**\r\n * Create a injectable provider for the WindowRef token that uses the BrowserWindowRef class.\r\n */\r\nexport const browserWindowProvider: ClassProvider = {\r\n  provide: WindowRef,\r\n  useClass: BrowserWindowRef\r\n};\r\n\r\n/**\r\n * Create an injectable provider that uses the windowFactory function for returning the native window object.\r\n */\r\nexport const windowProvider: FactoryProvider = {\r\n  provide: WINDOW,\r\n  useFactory: windowFactory,\r\n  deps: [WindowRef, PLATFORM_ID]\r\n};\r\n\r\n/**\r\n * Create an array of providers.\r\n */\r\nexport const WINDOW_PROVIDERS = [browserWindowProvider, windowProvider];\r\n","import { isPlatformBrowser } from '@angular/common';\r\nimport {\r\n  ClassProvider,\r\n  FactoryProvider,\r\n  InjectionToken,\r\n  PLATFORM_ID,\r\n} from '@angular/core';\r\n\r\n/**\r\n * Create a new injection token for injecting the Document into a component.\r\n */\r\nexport const DOCUMENT = new InjectionToken<Document>('DocumentToken');\r\n/**\r\n * Define abstract class for obtaining reference to the global Document object.\r\n */\r\nexport abstract class DocumentRef {\r\n  get nativeDocument(): Document | Object {\r\n    throw new Error('Not implemented.');\r\n  }\r\n}\r\n\r\n/**\r\n * Define class that implements the abstract class and returns the native Document object.\r\n */\r\nexport class BrowserDocumentRef extends DocumentRef {\r\n  constructor() {\r\n    super();\r\n  }\r\n\r\n  /**\r\n   * @returns Document object\r\n   */\r\n  get nativeDocument(): Document | Object {\r\n    return document;\r\n  }\r\n}\r\n\r\n/**\r\n * Create an factory function that returns the native Document object.\r\n * @param browserDocumentRef Native Document object\r\n * @param platformId id of platform\r\n * @returns type of platform of empty object\r\n */\r\nexport function documentFactory(\r\n  browserDocumentRef: BrowserDocumentRef,\r\n  platformId: Object\r\n): Document | Object {\r\n  if (isPlatformBrowser(platformId)) {\r\n    return browserDocumentRef.nativeDocument;\r\n  }\r\n  return new Object();\r\n}\r\n\r\n/**\r\n * Create a injectable provider for the DocumentRef token that uses the BrowserDocumentRef class.\r\n */\r\nexport const browserDocumentProvider: ClassProvider = {\r\n  provide: DocumentRef,\r\n  useClass: BrowserDocumentRef\r\n};\r\n\r\n/**\r\n * Create an injectable provider that uses the DocumentFactory function for returning the native Document object.\r\n */\r\nexport const documentProvider: FactoryProvider = {\r\n  provide: DOCUMENT,\r\n  useFactory: documentFactory,\r\n  deps: [DocumentRef, PLATFORM_ID]\r\n};\r\n\r\n/**\r\n * Create an array of providers.\r\n */\r\nexport const DOCUMENT_PROVIDERS = [browserDocumentProvider, documentProvider];\r\n","import { Injectable, Inject, OnDestroy } from '@angular/core';\r\nimport { Subscription, Observable, merge } from 'rxjs';\r\nimport { CarouselService } from './carousel.service';\r\nimport { tap } from 'rxjs/operators';\r\nimport { WINDOW } from './window-ref.service';\r\nimport { DOCUMENT } from './document-ref.service';\r\n\r\n@Injectable()\r\nexport class AutoplayService implements OnDestroy{\r\n  /**\r\n   * Subscrioption to merge Observables from CarouselService\r\n   */\r\n  autoplaySubscription: Subscription;\r\n\r\n  /**\r\n   * The autoplay timeout.\r\n   */\r\n  private _timeout: number = null;\r\n\r\n  /**\r\n   * Indicates whenever the autoplay is paused.\r\n   */\r\n  private _paused = false;\r\n\r\n  private winRef: Window;\r\n  private docRef: Document;\r\n\r\n  constructor(private carouselService: CarouselService,\r\n              @Inject(WINDOW) winRef: any,\r\n              @Inject(DOCUMENT) docRef: any,\r\n  ) {\r\n    this.winRef = winRef as Window;\r\n    this.docRef = docRef as Document;\r\n    this.spyDataStreams();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.autoplaySubscription.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Defines Observables which service must observe\r\n   */\r\n  spyDataStreams() {\r\n    const initializedCarousel$: Observable<string> = this.carouselService.getInitializedState().pipe(\r\n      tap(() => {\r\n        if (this.carouselService.settings.autoplay) {\r\n\t\t\t\t\tthis.play();\r\n\t\t\t\t}\r\n      })\r\n    );\r\n\r\n    const changedSettings$: Observable<any> = this.carouselService.getChangedState().pipe(\r\n      tap(data => {\r\n        this._handleChangeObservable(data);\r\n      })\r\n    );\r\n\r\n    // original Autoplay Plugin has listeners on play.owl.core and stop.owl.core events.\r\n    // They are triggered by Video Plugin\r\n\r\n    const autoplayMerge$: Observable<string> = merge(initializedCarousel$, changedSettings$);\r\n    this.autoplaySubscription = autoplayMerge$.subscribe(\r\n      () => {}\r\n    );\r\n  }\r\n\r\n  /**\r\n\t * Starts the autoplay.\r\n\t * @param timeout The interval before the next animation starts.\r\n\t * @param speed The animation speed for the animations.\r\n\t */\r\n\tplay(timeout?: number, speed?: number) {\r\n    if (this._paused) {\r\n\t\t\tthis._paused = false;\r\n\t\t\tthis._setAutoPlayInterval();\r\n    }\r\n\r\n\t\tif (this.carouselService.is('rotating')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.carouselService.enter('rotating');\r\n\r\n\t\tthis._setAutoPlayInterval();\r\n  };\r\n\r\n  /**\r\n\t * Gets a new timeout\r\n\t * @param timeout - The interval before the next animation starts.\r\n\t * @param speed - The animation speed for the animations.\r\n\t * @return\r\n\t */\r\n\tprivate _getNextTimeout(timeout?: number, speed?: number): number {\r\n\t\tif ( this._timeout ) {\r\n\t\t\tthis.winRef.clearTimeout(this._timeout);\r\n\t\t}\r\n\t\treturn this.winRef.setTimeout(() =>{\r\n      if (this._paused || this.carouselService.is('busy') || this.carouselService.is('interacting') || this.docRef.hidden) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis.carouselService.next(speed || this.carouselService.settings.autoplaySpeed);\r\n    }, timeout || this.carouselService.settings.autoplayTimeout);\r\n  };\r\n\r\n  /**\r\n\t * Sets autoplay in motion.\r\n\t */\r\n\tprivate _setAutoPlayInterval() {\r\n\t\tthis._timeout = this._getNextTimeout();\r\n\t};\r\n\r\n\t/**\r\n\t * Stops the autoplay.\r\n\t */\r\n\tstop() {\r\n\t\tif (!this.carouselService.is('rotating')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.winRef.clearTimeout(this._timeout);\r\n\t\tthis.carouselService.leave('rotating');\r\n  };\r\n\r\n  /**\r\n\t * Stops the autoplay.\r\n\t */\r\n\tpause() {\r\n\t\tif (!this.carouselService.is('rotating')) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._paused = true;\r\n  };\r\n\r\n  /**\r\n   * Manages by autoplaying according to data passed by _changedSettingsCarousel$ Obsarvable\r\n   * @param data object with current position of carousel and type of change\r\n   */\r\n  private _handleChangeObservable(data) {\r\n    if (data.property.name === 'settings') {\r\n      if (this.carouselService.settings.autoplay) {\r\n        this.play();\r\n      } else {\r\n        this.stop();\r\n      }\r\n    } else if (data.property.name === 'position') {\r\n      //console.log('play?', e);\r\n      if (this.carouselService.settings.autoplay) {\r\n        this._setAutoPlayInterval();\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Starts pausing\r\n   */\r\n  startPausing() {\r\n    if (this.carouselService.settings.autoplayHoverPause && this.carouselService.is('rotating')) {\r\n      this.pause();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Starts playing after mouse leaves carousel\r\n   */\r\n  startPlayingMouseLeave() {\r\n    if (this.carouselService.settings.autoplayHoverPause && this.carouselService.is('rotating')) {\r\n      this.pause();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Starts playing after touch ends\r\n   */\r\n  startPlayingTouchEnd() {\r\n    if (this.carouselService.settings.autoplayHoverPause && this.carouselService.is('rotating')) {\r\n      this.pause();\r\n    }\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { Subscription, Observable, merge } from 'rxjs';\r\nimport { CarouselService } from './carousel.service';\r\nimport { tap } from 'rxjs/operators';\r\n\r\n@Injectable()\r\nexport class LazyLoadService implements OnDestroy {\r\n  /**\r\n   * Subscrioption to merge Observable  from CarouselService\r\n   */\r\n  lazyLoadSubscription: Subscription;\r\n\r\n  constructor(private carouselService: CarouselService) {\r\n    this.spyDataStreams();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.lazyLoadSubscription.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Defines Observables which service must observe\r\n   */\r\n  spyDataStreams() {\r\n    const initializedCarousel$: Observable<string> = this.carouselService.getInitializedState().pipe(\r\n      tap(() => {\r\n        const isLazyLoad = this.carouselService.settings && !this.carouselService.settings.lazyLoad;\r\n        this.carouselService.slidesData.forEach(item => item.load = isLazyLoad ? true : false);\r\n      })\r\n    );\r\n\r\n    const changeSettings$: Observable<any> = this.carouselService.getChangeState();\r\n\r\n    const resizedCarousel$: Observable<string> = this.carouselService.getResizedState();\r\n\r\n\r\n    const lazyLoadMerge$: Observable<string | any> = merge(initializedCarousel$, changeSettings$, resizedCarousel$).pipe(\r\n      tap(data => this._defineLazyLoadSlides(data)),\r\n      // tap(() => this.carouselService.sendChanges())\r\n    );\r\n    this.lazyLoadSubscription = lazyLoadMerge$.subscribe(\r\n      () => {}\r\n    );\r\n  }\r\n\r\n  private _defineLazyLoadSlides(data: any) {\r\n    if (!this.carouselService.settings || !this.carouselService.settings.lazyLoad) {\r\n      return;\r\n    }\r\n\r\n    if ((data.property && data.property.name === 'position') || data === 'initialized' || data === \"resized\") {\r\n      const settings = this.carouselService.settings,\r\n            clones = this.carouselService.clones().length;\r\n      let n = (settings.center && Math.ceil(settings.items / 2) || settings.items),\r\n          i = ((settings.center && n * -1) || 0),\r\n          position = (data.property && data.property.value !== undefined ? data.property.value : this.carouselService.current()) + i;\r\n        // load = $.proxy(function(i, v) { this.load(v) }, this);\r\n      //TODO: Need documentation for this new option\r\n      if (settings.lazyLoadEager > 0) {\r\n        n += settings.lazyLoadEager;\r\n        // If the carousel is looping also preload images that are to the \"left\"\r\n        if (settings.loop) {\r\n          position -= settings.lazyLoadEager;\r\n          n++;\r\n        }\r\n      }\r\n\r\n      while (i++ < n) {\r\n        this._load(clones / 2 + this.carouselService.relative(position));\r\n        if (clones) {\r\n          this.carouselService.clones(this.carouselService.relative(position)).forEach(value => this._load(value));\r\n\r\n        }\r\n        position++;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n\t * Loads all resources of an item at the specified position.\r\n\t * @param position - The absolute position of the item.\r\n\t */\r\n  private _load(position: number) {\r\n    if (this.carouselService.slidesData[position].load) {\r\n      return;\r\n    }\r\n\r\n    this.carouselService.slidesData[position].load = true;\r\n  }\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { Subscription, Observable, merge } from 'rxjs';\r\nimport { CarouselService } from './carousel.service';\r\nimport { tap } from 'rxjs/operators';\r\n\r\n@Injectable()\r\nexport class AnimateService implements OnDestroy{\r\n  /**\r\n   * Subscrioption to merge Observable  from CarouselService\r\n   */\r\n  animateSubscription: Subscription;\r\n\r\n  /**\r\n   * s\r\n   */\r\n  swapping = true;\r\n\r\n  /**\r\n   * active slide before translating\r\n   */\r\n  previous = undefined;\r\n\r\n  /**\r\n   * new active slide after translating\r\n   */\r\n  next = undefined;\r\n\r\n  constructor(private carouselService: CarouselService) {\r\n    this.spyDataStreams();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.animateSubscription.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Defines Observables which service must observe\r\n   */\r\n  spyDataStreams() {\r\n    const changeSettings$: Observable<any> = this.carouselService.getChangeState().pipe(\r\n      tap(data => {\r\n        if (data.property.name === 'position') {\r\n\t\t\t\t\tthis.previous = this.carouselService.current();\r\n\t\t\t\t\tthis.next = data.property.value;\r\n\t\t\t\t}\r\n      })\r\n    );\r\n\r\n    const dragCarousel$: Observable<string> = this.carouselService.getDragState();\r\n    const draggedCarousel$: Observable<string> = this.carouselService.getDraggedState();\r\n    const translatedCarousel$: Observable<string> = this.carouselService.getTranslatedState();\r\n\r\n    const dragTranslatedMerge$: Observable<string> = merge(dragCarousel$, draggedCarousel$, translatedCarousel$).pipe(\r\n      tap(data => this.swapping = data === 'translated')\r\n    );\r\n\r\n    const translateCarousel$: Observable<string> = this.carouselService.getTranslateState().pipe(\r\n      tap(data => {\r\n        if (this.swapping && (this.carouselService._options.animateOut || this.carouselService._options.animateIn)) {\r\n          this._swap();\r\n        }\r\n      })\r\n    );\r\n\r\n    const animateMerge$: Observable<string | any> = merge(changeSettings$, translateCarousel$, dragTranslatedMerge$).pipe();\r\n    this.animateSubscription = animateMerge$.subscribe(\r\n      () => {}\r\n    );\r\n  }\r\n\r\n  /**\r\n\t * Toggles the animation classes whenever an translations starts.\r\n\t * @returns\r\n\t */\r\n\tprivate _swap(): boolean {\r\n\r\n\t\tif (this.carouselService.settings.items !== 1) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// if (!$.support.animation || !$.support.transition) {\r\n\t\t// \treturn;\r\n\t\t// }\r\n\r\n\t\tthis.carouselService.speed(0);\r\n\r\n\t\tlet left;\r\n\t\tconst\tprevious = this.carouselService.slidesData[this.previous],\r\n\t\t\tnext = this.carouselService.slidesData[this.next],\r\n\t\t\tincoming = this.carouselService.settings.animateIn,\r\n\t\t\toutgoing = this.carouselService.settings.animateOut;\r\n\r\n\t\tif (this.carouselService.current() === this.previous) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (outgoing) {\r\n\t\t\tleft = +this.carouselService.coordinates(this.previous) - +this.carouselService.coordinates(this.next);\r\n      this.carouselService.slidesData.forEach(slide => {\r\n        if (slide.id === previous.id) {\r\n          slide.left = `${left}px`;\r\n          slide.isAnimated = true;\r\n          slide.isDefAnimatedOut = true;\r\n          slide.isCustomAnimatedOut = true;\r\n        }\r\n      });\r\n\t\t}\r\n\r\n\t\tif (incoming) {\r\n      this.carouselService.slidesData.forEach(slide => {\r\n        if (slide.id === next.id) {\r\n          slide.isAnimated = true;\r\n          slide.isDefAnimatedIn = true;\r\n          slide.isCustomAnimatedIn = true;\r\n        }\r\n      });\r\n\t\t}\r\n\t};\r\n\r\n  /**\r\n   * Handles the end of 'animationend' event\r\n   * @param id Id of slides\r\n   */\r\n  clear(id) {\r\n    this.carouselService.slidesData.forEach(slide => {\r\n      if (slide.id === id) {\r\n        slide.left = '';\r\n        slide.isAnimated = false;\r\n        slide.isDefAnimatedOut = false;\r\n        slide.isCustomAnimatedOut = false;\r\n        slide.isDefAnimatedIn = false;\r\n        slide.isCustomAnimatedIn = false;\r\n        slide.classes = this.carouselService.setCurSlideClasses(slide);\r\n      }\r\n    });\r\n    this.carouselService.onTransitionEnd();\r\n\t};\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { Subscription, Observable, merge } from 'rxjs';\r\nimport { CarouselService } from './carousel.service';\r\nimport { tap } from 'rxjs/operators';\r\n\r\n@Injectable()\r\nexport class AutoHeightService implements OnDestroy{\r\n  /**\r\n   * Subscrioption to merge Observable  from CarouselService\r\n   */\r\n  autoHeightSubscription: Subscription;\r\n  constructor(private carouselService: CarouselService) {\r\n    this.spyDataStreams();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.autoHeightSubscription.unsubscribe();\r\n  }\r\n  /**\r\n   * Defines Observables which service must observe\r\n   */\r\n  spyDataStreams() {\r\n    const initializedCarousel$: Observable<string> = this.carouselService.getInitializedState().pipe(\r\n      tap(data => {\r\n        if (this.carouselService.settings.autoHeight) {\r\n          this.update();\r\n        } else {\r\n          this.carouselService.slidesData.forEach(slide => slide.heightState = 'full');\r\n        }\r\n      })\r\n    );\r\n\r\n    const changedSettings$: Observable<any> = this.carouselService.getChangedState().pipe(\r\n      tap(data => {\r\n        if (this.carouselService.settings.autoHeight && data.property.name === 'position'){\r\n\t\t\t\t\tthis.update();\r\n\t\t\t\t}\r\n      })\r\n    );\r\n\r\n    const refreshedCarousel$: Observable<string> = this.carouselService.getRefreshedState().pipe(\r\n      tap(data => {\r\n        if (this.carouselService.settings.autoHeight) {\r\n          this.update();\r\n        }\r\n      })\r\n    );\r\n\r\n    const autoHeight$: Observable<string | any> = merge(initializedCarousel$, changedSettings$, refreshedCarousel$);\r\n    this.autoHeightSubscription = autoHeight$.subscribe(\r\n      () => {}\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Updates the prop 'heightState' of slides\r\n   */\r\n  update() {\r\n    const items = this.carouselService.settings.items\r\n    let start = this.carouselService.current(),\r\n        end = start + items;\r\n\r\n    if (this.carouselService.settings.center) {\r\n      start = items % 2 === 1 ? start - (items - 1) / 2 : start - items / 2;\r\n      end = items % 2 === 1 ? start + items : start + items + 1;\r\n    }\r\n\r\n    this.carouselService.slidesData.forEach((slide, i) => {\r\n      slide.heightState = (i >= start && i < end) ? 'full' : 'nulled';\r\n    });\r\n  }\r\n\r\n\r\n}\r\n","import { Injectable, OnDestroy } from '@angular/core';\r\nimport { Subscription, Observable, merge } from 'rxjs';\r\nimport { CarouselService } from './carousel.service';\r\nimport { tap, skip } from 'rxjs/operators';\r\nimport { ActivatedRoute, Router } from '@angular/router';\r\n\r\n@Injectable()\r\nexport class HashService implements OnDestroy {\r\n  /**\r\n   * Subscription to merge Observable from CarouselService\r\n   */\r\n  hashSubscription: Subscription;\r\n\r\n  /**\r\n   * Current url fragment (hash)\r\n   */\r\n  currentHashFragment: string;\r\n\r\n  constructor(private carouselService: CarouselService,\r\n              private route: ActivatedRoute,\r\n              private router: Router) {\r\n    this.spyDataStreams();\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.hashSubscription.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Defines Observables which service must observe\r\n   */\r\n  spyDataStreams() {\r\n    const initializedCarousel$: Observable<string> = this.carouselService.getInitializedState().pipe(\r\n      tap(() => this.listenToRoute() )\r\n    );\r\n\r\n    const changedSettings$: Observable<any> = this.carouselService.getChangedState().pipe(\r\n      tap(data => {\r\n        if (this.carouselService.settings.URLhashListener && data.property.name === 'position') {\r\n          const newCurSlide = this.carouselService.current();\r\n          const newCurFragment = this.carouselService.slidesData[newCurSlide].hashFragment;\r\n\r\n          if (!newCurFragment || newCurFragment === this.currentHashFragment) {\r\n\t\t\t\t\t\treturn;\r\n          }\r\n          this.router.navigate(['./'], {fragment: newCurFragment, relativeTo: this.route});\r\n        }\r\n      })\r\n    );\r\n\r\n    const hashFragment$: Observable<string | any> = merge(initializedCarousel$, changedSettings$);\r\n    this.hashSubscription = hashFragment$.subscribe(\r\n      () => {}\r\n    );\r\n  }\r\n\r\n  /**\r\n   * rewinds carousel to slide which has the same hashFragment as fragment of current url\r\n   * @param fragment fragment of url\r\n   */\r\n  rewind(fragment: string) {\r\n    const position = this.carouselService.slidesData.findIndex(slide => slide.hashFragment === fragment && slide.isCloned === false);\r\n\r\n    if (position === -1 || position === this.carouselService.current()) {\r\n      return;\r\n    }\r\n\r\n\t\tthis.carouselService.to(this.carouselService.relative(position), false);\r\n  }\r\n\r\n  /**\r\n   * Initiate listening to ActivatedRoute.fragment\r\n   */\r\n  listenToRoute() {\r\n    const count = this.carouselService.settings.startPosition === 'URLHash' ? 0 : 2;\r\n    this.route.fragment.pipe(\r\n        skip(count)\r\n      )\r\n      .subscribe(\r\n        fragment => {\r\n          this.currentHashFragment = fragment;\r\n          this.rewind(fragment);\r\n        }\r\n      )\r\n  }\r\n}\r\n","import {\r\n  Component,\r\n  OnInit,\r\n  AfterContentChecked,\r\n  OnDestroy,\r\n  Input,\r\n  Output,\r\n  Directive,\r\n  QueryList,\r\n  ContentChildren,\r\n  TemplateRef,\r\n  ElementRef,\r\n  AfterContentInit,\r\n  EventEmitter\r\n} from '@angular/core';\r\n\r\nimport { Subscription, Observable, merge } from 'rxjs';\r\n\r\nimport { ResizeService } from '../services/resize.service';\r\nimport { tap, delay, filter, switchMap, first } from 'rxjs/operators';\r\nimport { CarouselService, CarouselCurrentData } from '../services/carousel.service';\r\nimport { StageData } from \"../models/stage-data.model\";\r\nimport { OwlDOMData } from \"../models/owlDOM-data.model\";\r\nimport { SlideModel } from '../models/slide.model';\r\nimport { OwlOptions } from '../models/owl-options.model';\r\nimport { NavData, DotsData } from '../models/navigation-data.models';\r\nimport { NavigationService } from '../services/navigation.service';\r\nimport { AutoplayService } from '../services/autoplay.service';\r\nimport { LazyLoadService } from '../services/lazyload.service';\r\nimport { AnimateService } from '../services/animate.service';\r\nimport { AutoHeightService } from '../services/autoheight.service';\r\nimport { HashService } from '../services/hash.service';\r\nimport { OwlLogger } from '../services/logger.service';\r\n\r\nlet nextId = 0;\r\n\r\n@Directive({ selector: 'ng-template[carouselSlide]' })\r\nexport class CarouselSlideDirective {\r\n  /**\r\n   * Unique slide identifier. Must be unique for the entire document for proper accessibility support.\r\n   * Will be auto-generated if not provided.\r\n   */\r\n  @Input() id = `owl-slide-${nextId++}`;\r\n\r\n  /**\r\n   * Defines how much widths of common slide will current slide have\r\n   * e.g. if _mergeData=2, the slide will twice wider then slides with _mergeData=1\r\n   */\r\n  private _dataMerge = 1;\r\n  @Input()\r\n  set dataMerge(data: number) {\r\n    this._dataMerge = this.isNumeric(data) ? data : 1;\r\n  };\r\n  get dataMerge(): number { return this._dataMerge }\r\n\r\n  /**\r\n   * Width of slide\r\n   */\r\n  @Input() width = 0;\r\n\r\n  /**\r\n   * Inner content of dot for certain slide; can be html-markup\r\n   */\r\n  @Input() dotContent = '';\r\n\r\n  /**\r\n   * Hash (fragment) of url which corresponds to certain slide\r\n   */\r\n  @Input() dataHash = '';\r\n\r\n  constructor(public tplRef: TemplateRef<any>) {}\r\n\r\n  /**\r\n\t * Determines if the input is a Number or something that can be coerced to a Number\r\n\t * @param - The input to be tested\r\n\t * @returns - An indication if the input is a Number or can be coerced to a Number\r\n\t */\r\n  isNumeric(number: any): boolean {\r\n\t\treturn !isNaN(parseFloat(number));\r\n\t}\r\n}\r\n\r\n/**\r\n * Data which will be passed out after ending of transition of carousel\r\n */\r\nexport class SlidesOutputData {\r\n  startPosition?: number;\r\n  slides?: SlideModel[];\r\n};\r\n\r\n@Component({\r\n  selector: 'owl-carousel-o',\r\n  template: `\r\n    <div class=\"owl-carousel owl-theme\" #owlCarousel\r\n      [ngClass]=\"{'owl-rtl': owlDOMData?.rtl,\r\n                  'owl-loaded': owlDOMData?.isLoaded,\r\n                  'owl-responsive': owlDOMData?.isResponsive,\r\n                  'owl-drag': owlDOMData?.isMouseDragable,\r\n                  'owl-grab': owlDOMData?.isGrab}\"\r\n      (mouseover)=\"startPausing()\"\r\n      (mouseleave)=\"startPlayML()\"\r\n      (touchstart)=\"startPausing()\"\r\n      (touchend)=\"startPlayTE()\">\r\n\r\n      <div *ngIf=\"carouselLoaded\" class=\"owl-stage-outer\">\r\n        <owl-stage [owlDraggable]=\"{'isMouseDragable': owlDOMData?.isMouseDragable, 'isTouchDragable': owlDOMData?.isTouchDragable}\"\r\n                    [stageData]=\"stageData\"\r\n                    [slidesData]=\"slidesData\"></owl-stage>\r\n      </div> <!-- /.owl-stage-outer -->\r\n      <ng-container *ngIf=\"slides.toArray().length\">\r\n        <div class=\"owl-nav\" [ngClass]=\"{'disabled': navData?.disabled}\">\r\n          <div class=\"owl-prev\" [ngClass]=\"{'disabled': navData?.prev?.disabled}\" (click)=\"prev()\" [innerHTML]=\"navData?.prev?.htmlText\"></div>\r\n          <div class=\"owl-next\" [ngClass]=\"{'disabled': navData?.next?.disabled}\" (click)=\"next()\" [innerHTML]=\"navData?.next?.htmlText\"></div>\r\n        </div> <!-- /.owl-nav -->\r\n        <div class=\"owl-dots\" [ngClass]=\"{'disabled': dotsData?.disabled}\">\r\n          <div *ngFor=\"let dot of dotsData?.dots\" class=\"owl-dot\" [ngClass]=\"{'active': dot.active, 'owl-dot-text': dot.showInnerContent}\" (click)=\"moveByDot(dot.id)\">\r\n            <span [innerHTML]=\"dot.innerContent\"></span>\r\n          </div>\r\n        </div> <!-- /.owl-dots -->\r\n      </ng-container>\r\n    </div> <!-- /.owl-carousel owl-loaded -->\r\n  `,\r\n  styles: [`.owl-theme { display: block; }`],\r\n  providers: [\r\n    NavigationService,\r\n    AutoplayService,\r\n    CarouselService,\r\n    LazyLoadService,\r\n    AnimateService,\r\n    AutoHeightService,\r\n    HashService\r\n  ]\r\n})\r\nexport class CarouselComponent\r\n  implements OnInit, AfterContentChecked, AfterContentInit, OnDestroy {\r\n  @ContentChildren(CarouselSlideDirective)\r\n  slides: QueryList<CarouselSlideDirective>;\r\n\r\n  @Output() translated = new EventEmitter<SlidesOutputData>();\r\n  @Output() dragging = new EventEmitter<boolean>();\r\n\r\n  /**\r\n   * Width of carousel window (tag with class .owl-carousel), in wich we can see moving sliders\r\n   */\r\n  carouselWindowWidth: number;\r\n\r\n  /**\r\n   * Subscription to 'resize' event\r\n   */\r\n  resizeSubscription: Subscription;\r\n\r\n  /**\r\n   * Subscription merge Observable, which merges all Observables in the component except 'resize' Observable and this.slides.changes()\r\n   */\r\n  private _allObservSubscription: Subscription;\r\n\r\n  /**\r\n   * Subscription to `this.slides.changes().\r\n   * It could be included in 'this._allObservSubscription', but that subcription get created during the initializing of component\r\n   * and 'this.slides' are undefined at that moment. So it's needed to wait for initialization of content.\r\n   */\r\n  private _slidesChangesSubscription: Subscription;\r\n\r\n  /**\r\n   * Current settings for the carousel.\r\n   */\r\n  owlDOMData: OwlDOMData;\r\n\r\n  /**\r\n   * Data of owl-stage\r\n   */\r\n\tstageData: StageData;\r\n\r\n\t/**\r\n\t *  Data of every slide\r\n\t */\r\n  slidesData: SlideModel[];\r\n\r\n  /**\r\n\t * Data of navigation block\r\n\t */\r\n\tnavData: NavData;\r\n\r\n\t/**\r\n\t * Data of dots block\r\n\t */\r\n  dotsData: DotsData;\r\n\r\n  /**\r\n   * Data, wich are passed out of carousel after ending of transioning of carousel\r\n   */\r\n  slidesOutputData: SlidesOutputData;\r\n\r\n  /**\r\n   * Shows whether carousel is loaded of not.\r\n   */\r\n  carouselLoaded = false;\r\n\r\n  /**\r\n   * User's options\r\n   */\r\n  @Input() options: OwlOptions;\r\n\r\n  /**\r\n   * Observable for getting current View Settings\r\n   */\r\n  private _viewCurSettings$: Observable<CarouselCurrentData>;\r\n\r\n  /**\r\n   * Observable for catching the end of transition of carousel\r\n   */\r\n  private _translatedCarousel$: Observable<string>;\r\n\r\n  /**\r\n   * Observable for catching the start of dragging of the carousel\r\n   */\r\n  private _draggingCarousel$: Observable<string>;\r\n\r\n  /**\r\n   * Observable for merging all Observables and creating one subscription\r\n   */\r\n  private _carouselMerge$: Observable<CarouselCurrentData | string>;\r\n\r\n  constructor(\r\n    private el: ElementRef,\r\n    private resizeService: ResizeService,\r\n    private carouselService: CarouselService,\r\n    private navigationService: NavigationService,\r\n    private autoplayService: AutoplayService,\r\n    private lazyLoadService: LazyLoadService,\r\n    private animateService: AnimateService,\r\n    private autoHeightService: AutoHeightService,\r\n    private hashService: HashService,\r\n    private logger: OwlLogger\r\n  ) {}\r\n\r\n  ngOnInit() {\r\n    this.spyDataStreams();\r\n\r\n    this.carouselWindowWidth = this.el.nativeElement.querySelector(\r\n      '.owl-carousel'\r\n    ).clientWidth;\r\n  }\r\n\r\n  ngAfterContentChecked() {\r\n  }\r\n  // ngAfterContentChecked() END\r\n\r\n  ngAfterContentInit() {\r\n    if (this.slides.toArray().length) {\r\n      this.carouselService.setup(this.carouselWindowWidth, this.slides.toArray(), this.options);\r\n      this.carouselService.initialize(this.slides.toArray());\r\n\r\n      this._winResizeWatcher();\r\n    } else {\r\n      this.logger.log(`There are no slides to show. So the carousel won't be rendered`);\r\n    }\r\n\r\n    this._slidesChangesSubscription = this.slides.changes.pipe(\r\n      tap((slides) => {\r\n        if (slides.toArray().length) {\r\n          // this.carouselService.setItems(slides.toArray());\r\n          this.carouselService.setup(this.carouselWindowWidth, slides.toArray(), this.options);\r\n          this.carouselService.initialize(slides.toArray());\r\n        } else {\r\n          this.carouselLoaded = false;\r\n          this.logger.log(`There are no slides to show. So the carousel won't be re-rendered`);\r\n        }\r\n      })\r\n    ).subscribe(()=>{});\r\n\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    if (this.resizeSubscription) {\r\n      this.resizeSubscription.unsubscribe();\r\n    }\r\n\r\n    this._slidesChangesSubscription.unsubscribe();\r\n\r\n    this._allObservSubscription.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Joins the observable login in one place: sets values to some observables, merges this observables and\r\n   * subcribes to merge func\r\n   */\r\n  spyDataStreams() {\r\n    this._viewCurSettings$ = this.carouselService.getViewCurSettings().pipe(\r\n      tap(data => {\r\n        this.owlDOMData = data.owlDOMData;\r\n        this.stageData = data.stageData;\r\n        this.slidesData = data.slidesData;\r\n        if (!this.carouselLoaded) {\r\n          this.carouselLoaded = true;\r\n        }\r\n        this.navData = data.navData;\r\n        this.dotsData = data.dotsData;\r\n      })\r\n    );\r\n\r\n    this._translatedCarousel$ = this.carouselService.getTranslatedState().pipe(\r\n      tap(() => {\r\n        this.gatherTranslatedData();\r\n        this.translated.emit(this.slidesOutputData);\r\n        this.slidesOutputData = {};\r\n      })\r\n    );\r\n\r\n    this._draggingCarousel$ = this.carouselService.getDragState().pipe(\r\n      tap(() => {\r\n        this.dragging.emit(true);\r\n      }),\r\n      switchMap(\r\n        () => this.carouselService.getTranslatedState().pipe(\r\n          first(),\r\n          tap(() => {\r\n            this.dragging.emit(false);\r\n          })\r\n        )\r\n      )\r\n    );\r\n\r\n    this._carouselMerge$ = merge(this._viewCurSettings$, this._translatedCarousel$, this._draggingCarousel$);\r\n    this._allObservSubscription = this._carouselMerge$.subscribe(() => {});\r\n  }\r\n\r\n  /**\r\n   * Init subscription to resize event and attaches handler for this event\r\n   */\r\n  private _winResizeWatcher() {\r\n    if (Object.keys(this.carouselService._options.responsive).length) {\r\n      this.resizeSubscription = this.resizeService.onResize$\r\n        .pipe(\r\n          filter(() => this.carouselWindowWidth !== this.el.nativeElement.querySelector('.owl-carousel').clientWidth),\r\n          delay(this.carouselService.settings.responsiveRefreshRate)\r\n        )\r\n        .subscribe(() => {\r\n          this.carouselService.onResize(this.el.nativeElement.querySelector('.owl-carousel').clientWidth);\r\n          this.carouselWindowWidth = this.el.nativeElement.querySelector('.owl-carousel').clientWidth;\r\n        });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handler for transitioend event\r\n   */\r\n  onTransitionEnd() {\r\n    this.carouselService.onTransitionEnd();\r\n  }\r\n\r\n  /**\r\n   * Handler for click event, attached to next button\r\n   */\r\n  next() {\r\n    if (!this.carouselLoaded || (this.navData && this.navData.disabled)) return;\r\n    this.navigationService.next(this.carouselService.settings.navSpeed);\r\n  }\r\n\r\n  /**\r\n   * Handler for click event, attached to prev button\r\n   */\r\n  prev() {\r\n    if (!this.carouselLoaded || (this.navData && this.navData.disabled)) return;\r\n    this.navigationService.prev(this.carouselService.settings.navSpeed);\r\n  }\r\n\r\n  /**\r\n   * Handler for click event, attached to dots\r\n   */\r\n  moveByDot(dotId: string) {\r\n    if (!this.carouselLoaded) return;\r\n    this.navigationService.moveByDot(dotId);\r\n  }\r\n\r\n  /**\r\n   * rewinds carousel to slide with needed id\r\n   * @param id fragment of url\r\n   */\r\n  to(id: string) {\r\n    if (!this.carouselLoaded || (this.navData && this.navData.disabled) || (this.dotsData && this.dotsData.disabled)) return;\r\n    this.navigationService.toSlideById(id);\r\n  }\r\n\r\n  /**\r\n   * Gathers and prepares data intended for passing to the user by means of firing event translatedCarousel\r\n   */\r\n  gatherTranslatedData() {\r\n    let startPosition: number;\r\n    const clonedIdPrefix = this.carouselService.clonedIdPrefix;\r\n    const activeSlides: SlideModel[] = this.slidesData\r\n      .filter(slide => slide.isActive === true)\r\n      .map(slide => {\r\n        const id = slide.id.indexOf(clonedIdPrefix) >= 0 ? slide.id.slice(clonedIdPrefix.length) : slide.id;\r\n        return {\r\n          id: id,\r\n          width: slide.width,\r\n          marginL: slide.marginL,\r\n          marginR: slide.marginR,\r\n          center: slide.isCentered\r\n        }\r\n      });\r\n    startPosition = this.carouselService.relative(this.carouselService.current());\r\n    this.slidesOutputData = {\r\n      startPosition: startPosition,\r\n      slides: activeSlides\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Starts pausing\r\n   */\r\n  startPausing() {\r\n    this.autoplayService.startPausing();\r\n  }\r\n\r\n  /**\r\n   * Starts playing after mouse leaves carousel\r\n   */\r\n  startPlayML() {\r\n    this.autoplayService.startPlayingMouseLeave();\r\n  }\r\n\r\n  /**\r\n   * Starts playing after touch ends\r\n   */\r\n  startPlayTE() {\r\n    this.autoplayService.startPlayingTouchEnd();\r\n  }\r\n\r\n}\r\n","import { Component, NgZone, ElementRef, HostListener, Renderer2, OnInit, OnDestroy, Input } from '@angular/core';\r\nimport { CarouselService, Coords } from '../../services/carousel.service';\r\nimport { Subject, Subscription } from 'rxjs';\r\nimport { first } from 'rxjs/operators';\r\nimport { StageData } from '../../models/stage-data.model';\r\nimport { SlideModel } from '../../models/slide.model';\r\nimport { AnimateService } from '../../services/animate.service';\r\nimport {\r\n  trigger,\r\n  state,\r\n  style,\r\n  animate,\r\n  transition\r\n} from '@angular/animations';\r\n@Component({\r\n  selector: 'owl-stage',\r\n  template: `\r\n    <div>\r\n      <div class=\"owl-stage\" [ngStyle]=\"{'width': stageData.width + 'px',\r\n                                        'transform': stageData.transform,\r\n                                        'transition': stageData.transition,\r\n                                        'padding-left': stageData.paddingL + 'px',\r\n                                        'padding-right': stageData.paddingR + 'px' }\"\r\n          (transitionend)=\"onTransitionEnd()\">\r\n        <ng-container *ngFor=\"let slide of slidesData; let i = index\">\r\n          <div class=\"owl-item\" [ngClass]=\"slide.classes\"\r\n                                [ngStyle]=\"{'width': slide.width + 'px',\r\n                                            'margin-left': slide.marginL + 'px',\r\n                                            'margin-right': slide.marginR + 'px',\r\n                                            'left': slide.left}\"\r\n                                (animationend)=\"clear(slide.id)\"\r\n                                [@autoHeight]=\"slide.heightState\">\r\n            <ng-template *ngIf=\"slide.load\" [ngTemplateOutlet]=\"slide.tplRef\"></ng-template>\r\n          </div><!-- /.owl-item -->\r\n        </ng-container>\r\n      </div><!-- /.owl-stage -->\r\n    </div>\r\n  `,\r\n  animations: [\r\n    trigger('autoHeight', [\r\n      state('nulled', style({height: 0})),\r\n      state('full', style({height: '*'})),\r\n      transition('full => nulled', [\r\n        // style({height: '*'}),\r\n        animate('700ms 350ms')\r\n      ]),\r\n      transition('nulled => full', [\r\n        // style({height: 0}),\r\n        animate(350)\r\n      ]),\r\n    ])\r\n  ]\r\n})\r\nexport class StageComponent implements OnInit, OnDestroy {\r\n  /**\r\n   * Object with settings which make carousel draggable by touch or mouse\r\n   */\r\n  @Input() owlDraggable: {\r\n    isMouseDragable: boolean,\r\n    isTouchDragable: boolean\r\n  };\r\n\r\n  /**\r\n   * Data of owl-stage\r\n   */\r\n  @Input() stageData: StageData;\r\n\r\n\t/**\r\n\t *  Data of every slide\r\n\t */\r\n  @Input() slidesData: SlideModel[];\r\n\r\n  /**\r\n   * Function wich will be returned after attaching listener to 'mousemove' event\r\n   */\r\n  listenerMouseMove: () => void;\r\n  /**\r\n   * Function wich will be returned after attaching listener to 'touchmove' event\r\n   */\r\n  listenerTouchMove: () => void;\r\n  /**\r\n   * Function wich will be returned after attaching listener to 'mousemove' event\r\n   */\r\n  listenerOneMouseMove: () => void;\r\n  /**\r\n   * Function wich will be returned after attaching listener to 'touchmove' event\r\n   */\r\n  listenerOneTouchMove: () => void;\r\n\r\n  /**\r\n   * Function wich will be returned after attaching listener to 'mouseup' event\r\n   */\r\n  listenerMouseUp: () => void;\r\n  /**\r\n   * Function wich will be returned after attaching listener to 'touchend' event\r\n   */\r\n  listenerTouchEnd: () => void;\r\n\r\n  /**\r\n   * Function wich will be returned after attaching listener to 'click' event\r\n   */\r\n  listenerOneClick: () => void;\r\n\r\n  listenerATag: () => void;\r\n\r\n  /**\r\n   * Object with data needed for dragging\r\n   */\r\n  private _drag: any = {\r\n    time: null,\r\n    target: null,\r\n    pointer: null,\r\n    stage: {\r\n      start: null,\r\n      current: null\r\n    },\r\n    direction: null,\r\n    active: false,\r\n    moving: false\r\n  };\r\n\r\n  /**\r\n   * Subject for notification when the carousel's rebuilding caused by resize event starts\r\n   */\r\n  private _oneDragMove$ = new Subject<any>();\r\n\r\n  /**\r\n   * Subsctiption to _oneDragMove$ Subject\r\n   */\r\n  private _oneMoveSubsription: Subscription;\r\n\r\n  constructor(private zone: NgZone,\r\n              private el: ElementRef,\r\n              private renderer: Renderer2,\r\n              private carouselService: CarouselService,\r\n              private animateService: AnimateService) { }\r\n\r\n  @HostListener('mousedown', ['$event']) onMouseDown(event) {\r\n    if (this.owlDraggable.isMouseDragable) {\r\n      this._onDragStart(event);\r\n    }\r\n  }\r\n\r\n  @HostListener('touchstart', ['$event']) onTouchStart(event) {\r\n    if (this.owlDraggable.isTouchDragable) {\r\n      this._onDragStart(event);\r\n    }\r\n  }\r\n\r\n  @HostListener('touchcancel', ['$event']) onTouchCancel(event) {\r\n    this._onDragEnd(event);\r\n  }\r\n\r\n  @HostListener('dragstart') onDragStart() {\r\n    if (this.owlDraggable.isMouseDragable) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  @HostListener('selectstart') onSelectStart() {\r\n    if (this.owlDraggable.isMouseDragable) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  ngOnInit() {\r\n    this._oneMoveSubsription = this._oneDragMove$\r\n      .pipe(first())\r\n      .subscribe(() => {\r\n        this._sendChanges();\r\n      });\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this._oneMoveSubsription.unsubscribe();\r\n  }\r\n\r\n  /**\r\n   * Passes this to _oneMouseTouchMove();\r\n   */\r\n  bindOneMouseTouchMove = (ev) => {\r\n    this._oneMouseTouchMove(ev);\r\n  }\r\n\r\n  /**\r\n   * Passes this to _onDragMove();\r\n   */\r\n  bindOnDragMove = (ev) => {\r\n    this._onDragMove(ev);\r\n  }\r\n\r\n  /**\r\n   * Passes this to _onDragMove();\r\n   */\r\n  bindOnDragEnd = (ev) => {\r\n    // this.zone.run(() => {\r\n      this._onDragEnd(ev);\r\n    // });\r\n  }\r\n\r\n  /**\r\n\t * Handles `touchstart` and `mousedown` events.\r\n\t * @todo Horizontal swipe threshold as option\r\n\t * @todo #261\r\n\t * @param event - The event arguments.\r\n\t */\r\n\tprivate _onDragStart(event): any {\r\n\t\tlet stage: Coords = null;\r\n\r\n\t\tif (event.which === 3) {\r\n\t\t\treturn;\r\n    }\r\n\r\n    stage = this._prepareDragging(event);\r\n\r\n\t\tthis._drag.time = new Date().getTime();\r\n\t\tthis._drag.target = event.target;\r\n\t\tthis._drag.stage.start = stage;\r\n\t\tthis._drag.stage.current = stage;\r\n    this._drag.pointer = this._pointer(event);\r\n    this._drag.active = true;\r\n\r\n    this.listenerMouseUp = this.renderer.listen(document, 'mouseup', this.bindOnDragEnd);\r\n    this.listenerTouchEnd = this.renderer.listen(document, 'touchend', this.bindOnDragEnd);\r\n\r\n    this.zone.runOutsideAngular(() => {\r\n      this.listenerOneMouseMove = this.renderer.listen(document, 'mousemove', this.bindOneMouseTouchMove);\r\n      this.listenerOneTouchMove = this.renderer.listen(document, 'touchmove', this.bindOneMouseTouchMove);\r\n    });\r\n\r\n  }\r\n\r\n  /**\r\n   * Attaches listeners to `touchmove` and `mousemove` events; initiates updating carousel after starting dragging\r\n   * @param event event objech of mouse or touch event\r\n   */\r\n  private _oneMouseTouchMove(event) {\r\n    if (!this._drag.active) return false;\r\n    const delta = this._difference(this._drag.pointer, this._pointer(event));\r\n    if (this.listenerATag) {\r\n      this.listenerATag();\r\n    }\r\n\r\n    this.listenerOneMouseMove();\r\n    this.listenerOneTouchMove();\r\n\r\n    if (Math.abs(delta.x) < Math.abs(delta.y) && this._is('valid')) {\r\n      this._drag.active = false;\r\n      return;\r\n    }\r\n    this._drag.moving = true;\r\n\r\n    this.blockClickAnchorInDragging(event);\r\n\r\n    this.listenerMouseMove = this.renderer.listen(document, 'mousemove', this.bindOnDragMove);\r\n    this.listenerTouchMove = this.renderer.listen(document, 'touchmove', this.bindOnDragMove);\r\n\r\n    event.preventDefault();\r\n\r\n    this._enterDragging();\r\n    this._oneDragMove$.next(event);\r\n    // this._sendChanges();\r\n  }\r\n\r\n  /**\r\n   * Attaches handler to HTMLAnchorElement for preventing click while carousel is being dragged\r\n   * @param event event object\r\n   */\r\n  private blockClickAnchorInDragging(event: any) {\r\n    let target: HTMLElement | null = event.target;\r\n    while (target && !(target instanceof HTMLAnchorElement)) {\r\n      target = target.parentElement;\r\n    }\r\n    if (target instanceof HTMLAnchorElement) {\r\n      this.listenerATag = this.renderer.listen(target, 'click', () => false);\r\n    }\r\n  }\r\n\r\n  \t/**\r\n\t * Handles the `touchmove` and `mousemove` events.\r\n\t * @todo #261\r\n\t * @param event - The event arguments.\r\n\t */\r\n\tprivate _onDragMove(event) {\r\n    if (!this._drag.active) return false;\r\n\r\n    let stage: Coords;\r\n    const stageOrExit: boolean | Coords = this.carouselService.defineNewCoordsDrag(event, this._drag);\r\n\r\n    if (stageOrExit === false) {\r\n      return;\r\n    }\r\n    stage = stageOrExit as Coords;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n    this._drag.stage.current = stage;\r\n\t\tthis._animate(stage.x - this._drag.stage.start.x);\r\n  };\r\n\r\n  /**\r\n   * Moves .owl-stage left-right\r\n   * @param coordinate coordinate to be set to .owl-stage\r\n   */\r\n  private _animate(coordinate: number) {\r\n    this.renderer.setStyle(this.el.nativeElement.children[0], 'transform', `translate3d(${coordinate}px,0px,0px`);\r\n    this.renderer.setStyle(this.el.nativeElement.children[0], 'transition', '0s');\r\n  }\r\n\r\n  /**\r\n\t * Handles the `touchend` and `mouseup` events.\r\n\t * @todo #261\r\n\t * @todo Threshold for click event\r\n\t * @param event - The event arguments.\r\n\t */\r\n\tprivate _onDragEnd(event) {\r\n    this.carouselService.owlDOMData.isGrab = false;\r\n\r\n    if (this._drag.moving) {\r\n      this.renderer.setStyle(this.el.nativeElement.children[0], 'transform', ``);\r\n      this.renderer.setStyle(this.el.nativeElement.children[0], 'transition', this.carouselService.speed(+this.carouselService.settings.dragEndSpeed || this.carouselService.settings.smartSpeed)/1000 +'s');\r\n\r\n      this._finishDragging(event);\r\n      this.listenerMouseMove();\r\n      this.listenerTouchMove();\r\n    }\r\n\r\n    this._drag = {\r\n      time: null,\r\n      target: null,\r\n      pointer: null,\r\n      stage: {\r\n        start: null,\r\n        current: null\r\n      },\r\n      direction: null,\r\n      active: false,\r\n      moving: false\r\n    };\r\n\r\n    // this.carouselService.trigger('dragged');\r\n    this.listenerMouseUp();\r\n    this.listenerTouchEnd();\r\n  };\r\n\r\n  /**\r\n\t * Prepares data for dragging carousel. It starts after firing `touchstart` and `mousedown` events.\r\n\t * @param event - The event arguments.\r\n\t * @returns stage - object with 'x' and 'y' coordinates of .owl-stage\r\n\t */\r\n  private _prepareDragging(event: any): Coords {\r\n    return this.carouselService.prepareDragging(event);\r\n  }\r\n\r\n  /**\r\n   * Attaches handler for 'click' event on any element in .owl-stage in order to prevent dragging when moving of cursor is less than 3px\r\n   */\r\n  private _oneClickHandler = () => {\r\n    this.listenerOneClick = this.renderer.listen(this._drag.target, 'click', () => false)\r\n    this.listenerOneClick();\r\n  }\r\n\r\n  /**\r\n   * Finishes dragging\r\n   * @param event object event of 'mouseUp' of 'touchend' events\r\n   */\r\n  private _finishDragging(event: any) {\r\n    this.carouselService.finishDragging(event, this._drag, this._oneClickHandler);\r\n  }\r\n\r\n  /**\r\n\t * Gets unified pointer coordinates from event.\r\n\t * @param event The `mousedown` or `touchstart` event.\r\n\t * @returns Contains `x` and `y` coordinates of current pointer position.\r\n\t */\r\n  private _pointer(event: any): any {\r\n    return this.carouselService.pointer(event);\r\n  }\r\n\r\n  /**\r\n\t * Gets the difference of two vectors.\r\n\t * @param first The first vector.\r\n\t * @param second- The second vector.\r\n\t * @returns The difference.\r\n\t */\r\n  private _difference(firstC: Coords, second: Coords): any {\r\n    return this.carouselService.difference(firstC, second);\r\n  }\r\n\r\n  /**\r\n\t * Checks whether the carousel is in a specific state or not.\r\n\t * @param specificState The state to check.\r\n\t * @returns The flag which indicates if the carousel is busy.\r\n\t */\r\n  private _is(specificState: string): boolean {\r\n    return this.carouselService.is(specificState);\r\n  }\r\n\r\n  /**\r\n  * Enters a state.\r\n  * @param name The state name.\r\n  */\r\n  private _enter(name: string) {\r\n    this.carouselService.enter(name);\r\n  }\r\n\r\n  /**\r\n\t * Sends all data needed for View.\r\n\t */\r\n  private _sendChanges() {\r\n    this.carouselService.sendChanges();\r\n  }\r\n\r\n  /**\r\n   * Handler for transitioend event\r\n   */\r\n  onTransitionEnd() {\r\n    this.carouselService.onTransitionEnd();\r\n  }\r\n\r\n  /**\r\n\t * Enters into a 'dragging' state\r\n\t */\r\n  private _enterDragging() {\r\n    this.carouselService.enterDragging();\r\n  }\r\n\r\n  /**\r\n   * Handles the end of 'animationend' event\r\n   * @param id Id of slides\r\n   */\r\n  clear(id) {\r\n    this.animateService.clear(id);\r\n  }\r\n}\r\n","import {LocationStrategy} from '@angular/common';\r\nimport {Attribute, Directive, ElementRef, HostBinding, HostListener, Input, OnChanges, OnDestroy, Renderer2, isDevMode} from '@angular/core';\r\nimport {Subscription} from 'rxjs';\r\n\r\nimport {NavigationEnd, RouterEvent, Router, ActivatedRoute, UrlTree} from '@angular/router';\r\n\r\nexport type QueryParamsHandling = 'merge' | 'preserve' | '';\r\n\r\n@Directive({selector: ':not(a)[owlRouterLink]'})\r\nexport class OwlRouterLinkDirective {\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() queryParams !: {[k: string]: any};\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() fragment !: string;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() queryParamsHandling !: QueryParamsHandling;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() preserveFragment !: boolean;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() skipLocationChange !: boolean;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() replaceUrl !: boolean;\r\n\r\n  @Input() stopLink = false;\r\n  private commands: any[] = [];\r\n  // TODO(issue/24571): remove '!'.\r\n  private preserve !: boolean;\r\n\r\n  constructor(\r\n      private router: Router, private route: ActivatedRoute,\r\n      @Attribute('tabindex') tabIndex: string, renderer: Renderer2, el: ElementRef) {\r\n    if (tabIndex == null) {\r\n      renderer.setAttribute(el.nativeElement, 'tabindex', '0');\r\n    }\r\n  }\r\n\r\n  @Input()\r\n  set owlRouterLink(commands: any[]|string) {\r\n    if (commands != null) {\r\n      this.commands = Array.isArray(commands) ? commands : [commands];\r\n    } else {\r\n      this.commands = [];\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @deprecated 4.0.0 use `queryParamsHandling` instead.\r\n   */\r\n  @Input()\r\n  set preserveQueryParams(value: boolean) {\r\n    if (isDevMode() && <any>console && <any>console.warn) {\r\n      console.warn('preserveQueryParams is deprecated!, use queryParamsHandling instead.');\r\n    }\r\n    this.preserve = value;\r\n  }\r\n\r\n  @HostListener('click')\r\n  onClick(): boolean {\r\n    const extras = {\r\n      skipLocationChange: attrBoolValue(this.skipLocationChange),\r\n      replaceUrl: attrBoolValue(this.replaceUrl),\r\n    };\r\n    if (this.stopLink) {\r\n      return false;\r\n    }\r\n    this.router.navigateByUrl(this.urlTree, extras);\r\n    return true;\r\n  }\r\n\r\n  get urlTree(): UrlTree {\r\n    return this.router.createUrlTree(this.commands, {\r\n      relativeTo: this.route,\r\n      queryParams: this.queryParams,\r\n      fragment: this.fragment,\r\n      preserveQueryParams: attrBoolValue(this.preserve),\r\n      queryParamsHandling: this.queryParamsHandling,\r\n      preserveFragment: attrBoolValue(this.preserveFragment),\r\n    });\r\n  }\r\n}\r\n\r\n/**\r\n * @description\r\n *\r\n * Lets you link to specific routes in your app.\r\n *\r\n * See `RouterLink` for more information.\r\n *\r\n * @ngModule RouterModule\r\n *\r\n * @publicApi\r\n */\r\n@Directive({selector: 'a[owlRouterLink]'})\r\nexport class OwlRouterLinkWithHrefDirective implements OnChanges, OnDestroy {\r\n  // TODO(issue/24571): remove '!'.\r\n  @HostBinding('attr.target') @Input() target !: string;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() queryParams !: {[k: string]: any};\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() fragment !: string;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() queryParamsHandling !: QueryParamsHandling;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() preserveFragment !: boolean;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() skipLocationChange !: boolean;\r\n  // TODO(issue/24571): remove '!'.\r\n  @Input() replaceUrl !: boolean;\r\n  @Input() stopLink = false;\r\n\r\n  private commands: any[] = [];\r\n  private subscription: Subscription;\r\n  // TODO(issue/24571): remove '!'.\r\n  private preserve !: boolean;\r\n\r\n  // the url displayed on the anchor element.\r\n  // TODO(issue/24571): remove '!'.\r\n  @HostBinding() href !: string;\r\n\r\n  constructor(\r\n      private router: Router, private route: ActivatedRoute,\r\n      private locationStrategy: LocationStrategy) {\r\n    this.subscription = router.events.subscribe((s: RouterEvent) => {\r\n      if (s instanceof NavigationEnd) {\r\n        this.updateTargetUrlAndHref();\r\n      }\r\n    });\r\n  }\r\n\r\n  @Input()\r\n  set owlRouterLink(commands: any[]|string) {\r\n    if (commands != null) {\r\n      this.commands = Array.isArray(commands) ? commands : [commands];\r\n    } else {\r\n      this.commands = [];\r\n    }\r\n  }\r\n\r\n  @Input()\r\n  set preserveQueryParams(value: boolean) {\r\n    if (isDevMode() && <any>console && <any>console.warn) {\r\n      console.warn('preserveQueryParams is deprecated, use queryParamsHandling instead.');\r\n    }\r\n    this.preserve = value;\r\n  }\r\n\r\n  ngOnChanges(changes: {}): any { this.updateTargetUrlAndHref(); }\r\n  ngOnDestroy(): any { this.subscription.unsubscribe(); }\r\n\r\n  @HostListener('click', ['$event.button', '$event.ctrlKey', '$event.metaKey', '$event.shiftKey'])\r\n  onClick(button: number, ctrlKey: boolean, metaKey: boolean, shiftKey: boolean): boolean {\r\n    if (button !== 0 || ctrlKey || metaKey || shiftKey) {\r\n      return true;\r\n    }\r\n\r\n    if (typeof this.target === 'string' && this.target !== '_self') {\r\n      return true;\r\n    }\r\n\r\n    if (this.stopLink) {\r\n      return false;\r\n    }\r\n\r\n    const extras = {\r\n      skipLocationChange: attrBoolValue(this.skipLocationChange),\r\n      replaceUrl: attrBoolValue(this.replaceUrl),\r\n    };\r\n    this.router.navigateByUrl(this.urlTree, extras);\r\n    return false;\r\n  }\r\n\r\n  private updateTargetUrlAndHref(): void {\r\n    this.href = this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree));\r\n  }\r\n\r\n  get urlTree(): UrlTree {\r\n    return this.router.createUrlTree(this.commands, {\r\n      relativeTo: this.route,\r\n      queryParams: this.queryParams,\r\n      fragment: this.fragment,\r\n      preserveQueryParams: attrBoolValue(this.preserve),\r\n      queryParamsHandling: this.queryParamsHandling,\r\n      preserveFragment: attrBoolValue(this.preserveFragment),\r\n    });\r\n  }\r\n}\r\n\r\nfunction attrBoolValue(s: any): boolean {\r\n  return s === '' || !!s;\r\n}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport {\r\n  CarouselComponent,\r\n  CarouselSlideDirective\r\n} from './carousel.component';\r\nimport { WINDOW_PROVIDERS } from '../services/window-ref.service';\r\nimport { ResizeService } from '../services/resize.service';\r\nimport { DOCUMENT_PROVIDERS } from '../services/document-ref.service';\r\nimport { StageComponent } from './stage/stage.component';\r\n// import { BrowserAnimationsModule } from '@angular/platform-browser/animations';\r\nexport {\r\n  CarouselComponent,\r\n  CarouselSlideDirective,\r\n  SlidesOutputData\r\n} from './carousel.component';\r\n\r\nimport { RouterModule, Routes } from '@angular/router';\r\nimport { OwlRouterLinkDirective, OwlRouterLinkWithHrefDirective } from './owl-router-link.directive';\r\nimport { OwlLogger } from '../services/logger.service';\r\nexport { OwlRouterLinkDirective, OwlRouterLinkWithHrefDirective } from './owl-router-link.directive';\r\n\r\nconst routes: Routes = [];\r\n\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    // BrowserAnimationsModule, // there's an issue with this import while using lazy loading of module consuming this library. I don't remove it because it could be needed during future enhancement of this lib.\r\n    RouterModule.forChild(routes)],\r\n  declarations: [CarouselComponent, CarouselSlideDirective, StageComponent, OwlRouterLinkDirective, OwlRouterLinkWithHrefDirective],\r\n  exports: [CarouselComponent, CarouselSlideDirective, OwlRouterLinkDirective, OwlRouterLinkWithHrefDirective],\r\n  providers: [WINDOW_PROVIDERS, ResizeService, DOCUMENT_PROVIDERS, OwlLogger]\r\n})\r\nexport class CarouselModule {}\r\n"]}